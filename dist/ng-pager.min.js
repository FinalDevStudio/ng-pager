!function(t){"use strict";function e(t){function e(e,i,n){function g(t,e,i,n){i=isNaN(i)?10:i,n=isNaN(n)?9:n,n%2||(console.log("[INFO]: displaySize of "+n+" forced into "+(n+1)),n++);for(var g=0,h=[],a=0,l=Math.floor(t/i);a<l;a++)h.push(++g);if(t%i!==0&&h.push(++g),h.length>n){var f=r(e-1,n,h);return f}return h}function r(t,e,i){t=t<0?0:t,t=t>i.length-1?i.length-1:t;var n={left:[],right:[],populate:function(){var e;if(t>0)for(e=t-1;e>0;e--)this.left.unshift(i[e]);if(t<i.length-1)for(e=t+1;e<i.length-1;e++)this.right.push(i[e])}},g={left:[],right:[],leftStepping:0,rightStepping:0,step:function(t,e){var i;if(e.left>0)for(this.leftStepping=Math.floor(t.left.length/e.left),i=t.left[t.left.length-1]+1-this.leftStepping;this.left.length<e.left;i-=this.leftStepping)this.left.unshift(i);if(e.right>0)for(this.rightStepping=Math.floor(t.right.length/e.right),i=t.right[0]-1+this.rightStepping;this.right.length<e.right;i+=this.rightStepping)this.right.push(i)}};n.populate();var r=a(n.left.length,n.right.length),l=h(t+1,e,i.length,r);return g.step(n,l),g.left.unshift(i[0]),g.right.push(i[i.length-1]),t>0&&t<i[i.length-1]&&g.left.push(i[t]),g.left.concat(g.right)}function h(t,e,i,n){var g={leftInt:0,leftDec:0,rightInt:0,rightDec:0,left:0,right:0,resWantedPages:1===t||t===i?e-2:e-3,calculate:function(){this.leftInt=l(this.resWantedPages*(n.left/100)).integerVal,this.leftDec=l(this.resWantedPages*(n.left/100)).decimalVal,this.rightInt=l(this.resWantedPages*(n.right/100)).integerVal,this.rightDec=l(this.resWantedPages*(n.right/100)).decimalVal;var t={left:this.leftInt,right:this.rightInt};return t.left+t.right!==this.resWantedPages&&(this.leftDec===this.rightDec?t.left>t.right?t.left++:t.right++:this.leftDec>this.rightDec?t.left++:t.right++),t}};return g.calculate()}function a(t,e){var i={left:0,right:0,ruleOfThree:function(i){return 100*i/(t+e)},define:function(){this.left=this.ruleOfThree(t),this.right=this.ruleOfThree(e)}};return i.define(),i}function l(t){var e={integerVal:0,decimalVal:0,tear:function(){this.integerVal=Math.floor(t),this.decimalVal=t%1}};return e.tear(),e}function f(t){e.total=parseInt(t.data||0),e.pageCount=parseInt(n.ngpPageCount),e.pages=g(e.total,e.page,e.pageCount),n.ngpStartPage&&(e.page=parseInt(n.ngpStartPage)||1,e.page>e.pages.length&&(e.page=e.pages.length),e.page<1&&(e.page=1),console.log("Start page: "+e.page))}function s(t){e.page=t,e.pager(t),e.pages=g(e.total,e.page,e.pageCount)}function p(){e.page<e.pages[e.pages.length-1]&&s(++e.page)}function o(){e.page>1&&s(--e.page)}function u(){t.get(n.ngpCountUrl).then(f)}e.setPage=s,e.reset=u,e.next=p,e.prev=o,e.page=1,u()}function i(t,e){return e.ngpTemplateUrl}var n={templateUrl:i,link:e,restrict:"A",scope:{pager:"=ngpPager"}};return n}var i=t.angular;i.module("ngPager",[]).directive("ngPager",["$http",e])}(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5nLXBhZ2VyLmpzIl0sIm5hbWVzIjpbIndpbmRvdyIsIm5nUGFnaW5hdGlvbkRpcmVjdGl2ZUZuIiwiJGh0dHAiLCJuZ1BhZ2luYXRpb25EaXJlY3RpdmVMaW5rRm4iLCIkc2NvcGUiLCIkZWxlbWVudCIsIiRhdHRycyIsInBhZ2VyIiwiZWxlbWVudHMiLCJjdXJyZW50UGFnZSIsImVsZW1lbnRzUGVyUGFnZSIsImRpc3BsYXlTaXplIiwiaXNOYU4iLCJjb25zb2xlIiwibG9nIiwicGFnZSIsInBhZ2VzIiwiaSIsImwiLCJNYXRoIiwiZmxvb3IiLCJwdXNoIiwibGVuZ3RoIiwic3RlcHBlZFBhZ2VzIiwicGFnaW5hdGUiLCJjdXJyZW50SW5kZXgiLCJzcGxpdFBhZ2VzIiwibGVmdCIsInJpZ2h0IiwicG9wdWxhdGUiLCJ0aGlzIiwidW5zaGlmdCIsImxlZnRTdGVwcGluZyIsInJpZ2h0U3RlcHBpbmciLCJzdGVwIiwiYmFsYW5jZSIsImJhbGFuY2VQZXJjZW50cyIsInBlcmNlbnQiLCJiYWxhbmNlcyIsImNvbmNhdCIsIndhbnRlZFBhZ2VzIiwibGFzdFBhZ2UiLCJwZXJjZW50YWdlcyIsInBlcmNCYWxhbmNlIiwibGVmdEludCIsImxlZnREZWMiLCJyaWdodEludCIsInJpZ2h0RGVjIiwicmVzV2FudGVkUGFnZXMiLCJjYWxjdWxhdGUiLCJ0ZWFyTnVtYmVyIiwiaW50ZWdlclZhbCIsImRlY2ltYWxWYWwiLCJyZXN1bHRzIiwibGVmdExlbmd0aCIsInJpZ2h0TGVuZ3RoIiwicnVsZU9mVGhyZWUiLCJkZWZpbmUiLCJpbnB1dE51bWJlciIsIm51bWJlciIsInRlYXIiLCJvbkNvdW50U3VjY2VzcyIsInJlcyIsInRvdGFsIiwicGFyc2VJbnQiLCJkYXRhIiwicGFnZUNvdW50IiwibmdwUGFnZUNvdW50IiwibmdwU3RhcnRQYWdlIiwic2V0UGFnZSIsIm5leHQiLCJwcmV2IiwicmVzZXQiLCJnZXQiLCJuZ3BDb3VudFVybCIsInRoZW4iLCJuZ1BhZ2luYXRpb25EaXJlY3RpdmVUZW1wbGF0ZVVybEZuIiwibmdwVGVtcGxhdGVVcmwiLCJuZ1BhZ2luYXRpb25EaXJlY3RpdmVEZWYiLCJ0ZW1wbGF0ZVVybCIsImxpbmsiLCJyZXN0cmljdCIsInNjb3BlIiwibmciLCJhbmd1bGFyIiwibW9kdWxlIiwiZGlyZWN0aXZlIl0sIm1hcHBpbmdzIjoiQ0FBQyxTQUFVQSxHQUNULFlBU0EsU0FBU0MsR0FBd0JDLEdBTS9CLFFBQVNDLEdBQTRCQyxFQUFRQyxFQUFVQyxHQUlyRCxRQUFTQyxHQUFNQyxFQUFVQyxFQUFhQyxFQUFpQkMsR0FFckRELEVBQW1CRSxNQUFNRixHQUFvQixHQUFLQSxFQUNsREMsRUFBZUMsTUFBTUQsR0FBZ0IsRUFBSUEsRUFFbkNBLEVBQWMsSUFDbEJFLFFBQVFDLElBQUksMEJBQTRCSCxFQUFjLGlCQUFtQkEsRUFBYyxJQUN2RkEsSUFNRixLQUFLLEdBSERJLEdBQU8sRUFDUEMsS0FFS0MsRUFBSSxFQUFHQyxFQUFJQyxLQUFLQyxNQUFNWixFQUFXRSxHQUFrQk8sRUFBSUMsRUFBR0QsSUFDakVELEVBQU1LLE9BQU9OLEVBT2YsSUFKSVAsRUFBV0UsSUFBb0IsR0FDakNNLEVBQU1LLE9BQU9OLEdBR1hDLEVBQU1NLE9BQVNYLEVBQWEsQ0FDOUIsR0FBSVksR0FBZUMsRUFBU2YsRUFBYyxFQUFHRSxFQUFhSyxFQUMxRCxPQUFPTyxHQUVQLE1BQU9QLEdBT1gsUUFBU1EsR0FBU0MsRUFBY2QsRUFBYUssR0FDM0NTLEVBQWdCQSxFQUFlLEVBQUssRUFBSUEsRUFDeENBLEVBQWdCQSxFQUFnQlQsRUFBTU0sT0FBUyxFQUFPTixFQUFNTSxPQUFTLEVBQUtHLENBRTFFLElBQUlDLElBQ0ZDLFFBQ0FDLFNBRUFDLFNBQVUsV0FDUixHQUFJWixFQUVKLElBQUlRLEVBQWUsRUFDakIsSUFBS1IsRUFBS1EsRUFBZSxFQUFJUixFQUFJLEVBQUdBLElBQ2xDYSxLQUFLSCxLQUFLSSxRQUFRZixFQUFNQyxHQUk1QixJQUFJUSxFQUFnQlQsRUFBTU0sT0FBUyxF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QVVDLEdBQ3BELE1BQU9BLEdBQU91RSxlQUloQixHQUFJQyxJQUNGQyxZQUFhSCxFQUViSSxLQUFNN0UsRUFFTjhFLFNBQVUsSUFFVkMsT0FDRTNFLE1BQU8sYUFJWCxPQUFPdUUsR0F2VFQsR0FBSUssR0FBS25GLEVBQU9vRixPQTJUaEJELEdBQUdFLE9BQU8sY0FHUEMsVUFBVSxXQUNULFFBRUFyRixLQUdKRCIsImZpbGUiOiJuZy1wYWdlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAod2luZG93KSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgbmcgPSB3aW5kb3cuYW5ndWxhcjtcblxuICAvKipcbiAgICogUGFnaW5hdGlvbiBkaXJlY3RpdmUgZnVuY3Rpb24uXG4gICAqXG4gICAqIEB0eXBlIEFuZ3VsYXJKUyBEaXJlY3RpdmUgRnVuY3Rpb25cbiAgICovXG4gIGZ1bmN0aW9uIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZUZuKCRodHRwKSB7XG4gICAgLyoqXG4gICAgICogUGFnaW5hdGlvbiBkaXJlY3RpdmUgbGluayBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEB0eXBlIEFuZ3VsYXJKUyBEaXJlY3RpdmUgTGluayBGdW5jdGlvblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZUxpbmtGbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICAgIC8qKlxuICAgICAgICogRElTUExBWSBTSVpFIE1VU1QgQkUgQU4gT0REIE5VTUJFUi4gSUYgSVQnUyBOT1QsIElUIFdJTEwgQkUgRk9SQ0VEIElOVE8gVEhFIE5FWFQgT0REIE5VTUJFUiBVUFdBUkRTLlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBwYWdlcihlbGVtZW50cywgY3VycmVudFBhZ2UsIGVsZW1lbnRzUGVyUGFnZSwgZGlzcGxheVNpemUpIHtcblxuICAgICAgICBlbGVtZW50c1BlclBhZ2UgPSAoaXNOYU4oZWxlbWVudHNQZXJQYWdlKSkgPyAxMCA6IGVsZW1lbnRzUGVyUGFnZTtcbiAgICAgICAgZGlzcGxheVNpemUgPSAoaXNOYU4oZGlzcGxheVNpemUpKSA/IDkgOiBkaXNwbGF5U2l6ZTtcblxuICAgICAgICBpZiAoIShkaXNwbGF5U2l6ZSAlIDIpKSB7IC8vIENoZWNrIGlmIE5PVCBvZGRcbiAgICAgICAgICBjb25zb2xlLmxvZygnW0lORk9dOiBkaXNwbGF5U2l6ZSBvZiAnICsgZGlzcGxheVNpemUgKyAnIGZvcmNlZCBpbnRvICcgKyAoZGlzcGxheVNpemUgKyAxKSk7XG4gICAgICAgICAgZGlzcGxheVNpemUrKztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBwYWdlID0gMDtcbiAgICAgICAgdmFyIHBhZ2VzID0gW107XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBNYXRoLmZsb29yKGVsZW1lbnRzIC8gZWxlbWVudHNQZXJQYWdlKTsgaSA8IGw7IGkrKykge1xuICAgICAgICAgIHBhZ2VzLnB1c2goKytwYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbGVtZW50cyAlIGVsZW1lbnRzUGVyUGFnZSAhPT0gMCkge1xuICAgICAgICAgIHBhZ2VzLnB1c2goKytwYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYWdlcy5sZW5ndGggPiBkaXNwbGF5U2l6ZSkge1xuICAgICAgICAgIHZhciBzdGVwcGVkUGFnZXMgPSBwYWdpbmF0ZShjdXJyZW50UGFnZSAtIDEsIGRpc3BsYXlTaXplLCBwYWdlcyk7XG4gICAgICAgICAgcmV0dXJuIHN0ZXBwZWRQYWdlcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gcGFnZXM7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiAgXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIHBhZ2luYXRlKGN1cnJlbnRJbmRleCwgZGlzcGxheVNpemUsIHBhZ2VzKSB7XG4gICAgICAgIGN1cnJlbnRJbmRleCA9IChjdXJyZW50SW5kZXggPCAwKSA/IDAgOiBjdXJyZW50SW5kZXg7XG4gICAgICAgIGN1cnJlbnRJbmRleCA9IChjdXJyZW50SW5kZXggPiAocGFnZXMubGVuZ3RoIC0gMSkpID8gKHBhZ2VzLmxlbmd0aCAtIDEpIDogY3VycmVudEluZGV4O1xuXG4gICAgICAgIHZhciBzcGxpdFBhZ2VzID0ge1xuICAgICAgICAgIGxlZnQ6IFtdLFxuICAgICAgICAgIHJpZ2h0OiBbXSxcblxuICAgICAgICAgIHBvcHVsYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaTtcblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgZm9yIChpID0gKGN1cnJlbnRJbmRleCAtIDEpOyBpID4gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sZWZ0LnVuc2hpZnQocGFnZXNbaV0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjdXJyZW50SW5kZXggPCAocGFnZXMubGVuZ3RoIC0gMSkpIHtcbiAgICAgICAgICAgICAgZm9yIChpID0gKGN1cnJlbnRJbmRleCArIDEpOyBpIDwgKHBhZ2VzLmxlbmd0aCAtIDEpOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0LnB1c2gocGFnZXNbaV0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBzdGVwcGVkUGFnZXMgPSB7XG4gICAgICAgICAgbGVmdDogW10sXG4gICAgICAgICAgcmlnaHQ6IFtdLFxuXG4gICAgICAgICAgbGVmdFN0ZXBwaW5nOiAwLFxuICAgICAgICAgIHJpZ2h0U3RlcHBpbmc6IDAsXG5cbiAgICAgICAgICBzdGVwOiBmdW5jdGlvbiAoc3BsaXRQYWdlcywgYmFsYW5jZSkge1xuICAgICAgICAgICAgdmFyIGk7XG5cbiAgICAgICAgICAgIGlmIChiYWxhbmNlLmxlZnQgPiAwKSB7XG4gICAgICAgICAgICAgIHRoaXMubGVmdFN0ZXBwaW5nID0gTWF0aC5mbG9vcihzcGxpdFBhZ2VzLmxlZnQubGVuZ3RoIC8gYmFsYW5jZS5sZWZ0KTtcblxuICAgICAgICAgICAgICBmb3IgKGkgPSAoc3BsaXRQYWdlcy5sZWZ0W3NwbGl0UGFnZXMubGVmdC5sZW5ndGggLSAxXSArIDEpIC0gdGhpcy5sZWZ0U3RlcHBpbmc7IHRoaXMubGVmdC5sZW5ndGggPCBiYWxhbmNlLmxlZnQ7IGkgPSAoaSAtIHRoaXMubGVmdFN0ZXBwaW5nKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubGVmdC51bnNoaWZ0KGkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChiYWxhbmNlLnJpZ2h0ID4gMCkge1xuICAgICAgICAgICAgICB0aGlzLnJpZ2h0U3RlcHBpbmcgPSBNYXRoLmZsb29yKHNwbGl0UGFnZXMucmlnaHQubGVuZ3RoIC8gYmFsYW5jZS5yaWdodCk7XG5cbiAgICAgICAgICAgICAgZm9yIChpID0gKHNwbGl0UGFnZXMucmlnaHRbMF0gLSAxKSArIHRoaXMucmlnaHRTdGVwcGluZzsgdGhpcy5yaWdodC5sZW5ndGggPCBiYWxhbmNlLnJpZ2h0OyBpID0gKGkgKyB0aGlzLnJpZ2h0U3RlcHBpbmcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodC5wdXNoKGkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHNwbGl0UGFnZXMucG9wdWxhdGUoKTtcblxuICAgICAgICB2YXIgYmFsYW5jZVBlcmNlbnRzID0gcGVyY2VudChzcGxpdFBhZ2VzLmxlZnQubGVuZ3RoLCBzcGxpdFBhZ2VzLnJpZ2h0Lmxlbmd0aCk7XG5cbiAgICAgICAgdmFyIGJhbGFuY2VzID0gYmFsYW5jZSgoY3VycmVudEluZGV4ICsgMSksIGRpc3BsYXlTaXplLCBwYWdlcy5sZW5ndGgsIGJhbGFuY2VQZXJjZW50cyk7XG5cbiAgICAgICAgc3RlcHBlZFBhZ2VzLnN0ZXAoc3BsaXRQYWdlcywgYmFsYW5jZXMpO1xuXG4gICAgICAgIHN0ZXBwZWRQYWdlcy5sZWZ0LnVuc2hpZnQocGFnZXNbMF0pO1xuICAgICAgICBzdGVwcGVkUGFnZXMucmlnaHQucHVzaChwYWdlc1twYWdlcy5sZW5ndGggLSAxXSk7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRJbmRleCA+IDAgJiYgY3VycmVudEluZGV4IDwgcGFnZXNbcGFnZXMubGVuZ3RoIC0gMV0pIHtcbiAgICAgICAgICBzdGVwcGVkUGFnZXMubGVmdC5wdXNoKHBhZ2VzW2N1cnJlbnRJbmRleF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN0ZXBwZWRQYWdlcy5sZWZ0LmNvbmNhdChzdGVwcGVkUGFnZXMucmlnaHQpO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIFxuICAgICAgICogQHBhcmFtIHsqfSBjdXJyZW50UGFnZSBcbiAgICAgICAqIEBwYXJhbSB7Kn0gd2FudGVkUGFnZXMgXG4gICAgICAgKiBAcGFyYW0geyp9IGxhc3RQYWdlIFxuICAgICAgICogQHBhcmFtIHsqfSBwZXJjZW50YWdlcyBcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gYmFsYW5jZShjdXJyZW50UGFnZSwgd2FudGVkUGFnZXMsIGxhc3RQYWdlLCBwZXJjZW50YWdlcykge1xuXG4gICAgICAgIHZhciBwZXJjQmFsYW5jZSA9IHtcbiAgICAgICAgICBsZWZ0SW50OiAwLFxuICAgICAgICAgIGxlZnREZWM6IDAsXG5cbiAgICAgICAgICByaWdodEludDogMCxcbiAgICAgICAgICByaWdodERlYzogMCxcblxuICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgcmlnaHQ6IDAsXG5cbiAgICAgICAgICByZXNXYW50ZWRQYWdlczogKGN1cnJlbnRQYWdlID09PSAxIHx8IGN1cnJlbnRQYWdlID09PSBsYXN0UGFnZSkgPyAod2FudGVkUGFnZXMgLSAyKSA6ICh3YW50ZWRQYWdlcyAtIDMpLFxuXG4gICAgICAgICAgY2FsY3VsYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmxlZnRJbnQgPSB0ZWFyTnVtYmVyKHRoaXMucmVzV2FudGVkUGFnZXMgKiAocGVyY2VudGFnZXMubGVmdCAvIDEwMCkpLmludGVnZXJWYWw7XG4gICAgICAgICAgICB0aGlzLmxlZnREZWMgPSB0ZWFyTnVtYmVyKHRoaXMucmVzV2FudGVkUGFnZXMgKiAocGVyY2VudGFnZXMubGVmdCAvIDEwMCkpLmRlY2ltYWxWYWw7XG5cbiAgICAgICAgICAgIHRoaXMucmlnaHRJbnQgPSB0ZWFyTnVtYmVyKHRoaXMucmVzV2FudGVkUGFnZXMgKiAocGVyY2VudGFnZXMucmlnaHQgLyAxMDApKS5pbnRlZ2VyVmFsO1xuICAgICAgICAgICAgdGhpcy5yaWdodERlYyA9IHRlYXJOdW1iZXIodGhpcy5yZXNXYW50ZWRQYWdlcyAqIChwZXJjZW50YWdlcy5yaWdodCAvIDEwMCkpLmRlY2ltYWxWYWw7XG5cbiAgICAgICAgICAgIHZhciByZXN1bHRzID0ge1xuICAgICAgICAgICAgICBsZWZ0OiB0aGlzLmxlZnRJbnQsXG4gICAgICAgICAgICAgIHJpZ2h0OiB0aGlzLnJpZ2h0SW50XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoKHJlc3VsdHMubGVmdCArIHJlc3VsdHMucmlnaHQpICE9PSB0aGlzLnJlc1dhbnRlZFBhZ2VzKSB7XG4gICAgICAgICAgICAgIGlmICh0aGlzLmxlZnREZWMgPT09IHRoaXMucmlnaHREZWMpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0cy5sZWZ0ID4gcmVzdWx0cy5yaWdodCkge1xuICAgICAgICAgICAgICAgICAgcmVzdWx0cy5sZWZ0Kys7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHJlc3VsdHMucmlnaHQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGVmdERlYyA+IHRoaXMucmlnaHREZWMpIHtcbiAgICAgICAgICAgICAgICAgIHJlc3VsdHMubGVmdCsrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXN1bHRzLnJpZ2h0Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gcGVyY0JhbGFuY2UuY2FsY3VsYXRlKCk7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogXG4gICAgICAgKiBAcGFyYW0geyp9IGxlZnRMZW5ndGggXG4gICAgICAgKiBAcGFyYW0geyp9IHJpZ2h0TGVuZ3RoIFxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBwZXJjZW50KGxlZnRMZW5ndGgsIHJpZ2h0TGVuZ3RoKSB7XG5cbiAgICAgICAgdmFyIHBlcmNlbnRhZ2VzID0ge1xuICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgcmlnaHQ6IDAsXG5cbiAgICAgICAgICBydWxlT2ZUaHJlZTogZnVuY3Rpb24gKGxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuICgxMDAgKiBsZW5ndGgpIC8gKGxlZnRMZW5ndGggKyByaWdodExlbmd0aCk7XG4gICAgICAgICAgfSxcblxuICAgICAgICAgIGRlZmluZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5sZWZ0ID0gdGhpcy5ydWxlT2ZUaHJlZShsZWZ0TGVuZ3RoKTtcbiAgICAgICAgICAgIHRoaXMucmlnaHQgPSB0aGlzLnJ1bGVPZlRocmVlKHJpZ2h0TGVuZ3RoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgcGVyY2VudGFnZXMuZGVmaW5lKCk7XG5cbiAgICAgICAgcmV0dXJuIHBlcmNlbnRhZ2VzO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiB0ZWFyTnVtYmVyKGlucHV0TnVtYmVyKSB7XG5cbiAgICAgICAgdmFyIG51bWJlciA9IHtcbiAgICAgICAgICBpbnRlZ2VyVmFsOiAwLFxuICAgICAgICAgIGRlY2ltYWxWYWw6IDAsXG5cbiAgICAgICAgICB0ZWFyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmludGVnZXJWYWwgPSBNYXRoLmZsb29yKGlucHV0TnVtYmVyKTtcbiAgICAgICAgICAgIHRoaXMuZGVjaW1hbFZhbCA9IChpbnB1dE51bWJlciAlIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBudW1iZXIudGVhcigpO1xuXG4gICAgICAgIHJldHVybiBudW1iZXI7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogT24gY291bnQgcmVxdWVzdCBzdWNjZXNzLlxuICAgICAgICpcbiAgICAgICAqIEB0eXBlICRodHRwIHRoZW4gY2FsbGJhY2suXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIG9uQ291bnRTdWNjZXNzKHJlcykge1xuICAgICAgICAkc2NvcGUudG90YWwgPSBwYXJzZUludChyZXMuZGF0YSB8fCAwKTtcbiAgICAgICAgJHNjb3BlLnBhZ2VDb3VudCA9IHBhcnNlSW50KCRhdHRycy5uZ3BQYWdlQ291bnQpO1xuICAgICAgICAkc2NvcGUucGFnZXMgPSBwYWdlcigkc2NvcGUudG90YWwsICRzY29wZS5wYWdlLCAkc2NvcGUucGFnZUNvdW50KTtcbiAgICAgICAgLy8kc2NvcGUucGFnZXMgPSBuZXcgQXJyYXkoTWF0aC5jZWlsKCRzY29wZS50b3RhbCAvICRzY29wZS5wYWdlQ291bnQpKTtcblxuICAgICAgICBpZiAoJGF0dHJzLm5ncFN0YXJ0UGFnZSkge1xuICAgICAgICAgICRzY29wZS5wYWdlID0gcGFyc2VJbnQoJGF0dHJzLm5ncFN0YXJ0UGFnZSkgfHwgMTtcblxuICAgICAgICAgIGlmICgkc2NvcGUucGFnZSA+ICRzY29wZS5wYWdlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICRzY29wZS5wYWdlID0gJHNjb3BlLnBhZ2VzLmxlbmd0aDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoJHNjb3BlLnBhZ2UgPCAxKSB7XG4gICAgICAgICAgICAkc2NvcGUucGFnZSA9IDE7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc29sZS5sb2coJ1N0YXJ0IHBhZ2U6ICcgKyAkc2NvcGUucGFnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBTZXRzIHRoZSBjdXJyZW50IHBhZ2UuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHBhZ2UgVGhlIHBhZ2UgbnVtYmVyIHRvIHNldC5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gc2V0UGFnZShwYWdlKSB7XG4gICAgICAgICRzY29wZS5wYWdlID0gcGFnZTtcbiAgICAgICAgJHNjb3BlLnBhZ2VyKHBhZ2UpO1xuXG4gICAgICAgICRzY29wZS5wYWdlcyA9IHBhZ2VyKCRzY29wZS50b3RhbCwgJHNjb3BlLnBhZ2UsICRzY29wZS5wYWdlQ291bnQpO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIEdvZXMgdG8gdGhlIG5leHQgcGFnZS5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgaWYgKCRzY29wZS5wYWdlIDwgJHNjb3BlLnBhZ2VzWyRzY29wZS5wYWdlcy5sZW5ndGggLSAxXSkge1xuICAgICAgICAgIHNldFBhZ2UoKyskc2NvcGUucGFnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBHb2VzIHRvIHRoZSBwcmV2aW91cyBwYWdlLlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBwcmV2KCkge1xuICAgICAgICBpZiAoJHNjb3BlLnBhZ2UgPiAxKSB7XG4gICAgICAgICAgc2V0UGFnZSgtLSRzY29wZS5wYWdlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgICAgJGh0dHAuZ2V0KCRhdHRycy5uZ3BDb3VudFVybClcbiAgICAgICAgICAudGhlbihvbkNvdW50U3VjY2Vzcyk7XG4gICAgICB9XG5cbiAgICAgICRzY29wZS5zZXRQYWdlID0gc2V0UGFnZTtcbiAgICAgICRzY29wZS5yZXNldCA9IHJlc2V0O1xuICAgICAgJHNjb3BlLm5leHQgPSBuZXh0O1xuICAgICAgJHNjb3BlLnByZXYgPSBwcmV2O1xuICAgICAgJHNjb3BlLnBhZ2UgPSAxO1xuXG4gICAgICByZXNldCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhZ2luYXRpb24gZGlyZWN0aXZlIHRlbXBsYXRlIFVSTCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEB0eXBlIEFuZ3VsYXJKUyBEaXJlY3RpdmUgVGVtcGxhdGUgVVJMIEZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZVRlbXBsYXRlVXJsRm4oJGVsZW1lbnQsICRhdHRycykge1xuICAgICAgcmV0dXJuICRhdHRycy5uZ3BUZW1wbGF0ZVVybDtcbiAgICB9XG5cbiAgICAvKiBQYWdpbmF0aW9uIGRpcmVjdGl2ZSBkZWZpbml0aW9uICovXG4gICAgdmFyIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZURlZiA9IHtcbiAgICAgIHRlbXBsYXRlVXJsOiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVUZW1wbGF0ZVVybEZuLFxuXG4gICAgICBsaW5rOiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVMaW5rRm4sXG5cbiAgICAgIHJlc3RyaWN0OiAnQScsXG5cbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHBhZ2VyOiAnPW5ncFBhZ2VyJ1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gbmdQYWdpbmF0aW9uRGlyZWN0aXZlRGVmO1xuICB9XG5cbiAgLyogRGVmaW5lIHRoZSBBbmd1bGFySlMgbW9kdWxlICovXG4gIG5nLm1vZHVsZSgnbmdQYWdlcicsIFtdKVxuXG4gICAgLyogRGVmaW5lIHRoZSBBbmd1bGFySlMgZGlyZWN0aXZlICovXG4gICAgLmRpcmVjdGl2ZSgnbmdQYWdlcicsIFtcbiAgICAgICckaHR0cCcsXG5cbiAgICAgIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZUZuXG4gICAgXSk7XG5cbn0od2luZG93KSk7Il19
