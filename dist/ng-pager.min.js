!function(t){"use strict";function e(t){function e(e,i,n){function g(t,e,i,n){i=isNaN(i)?10:i,n=isNaN(n)?9:n,n%2||(console.log("[INFO]: displaySize of "+n+" forced into "+(n+1)),n++);for(var g=0,h=[],a=0,l=Math.floor(t/i);a<l;a++)h.push(++g);if(t%i!==0&&h.push(++g),h.length>n){var f=r(e-1,n,h);return f}return h}function r(t,e,i){t=t<0?0:t,t=t>i.length-1?i.length-1:t;var n={left:[],right:[],populate:function(){var e;if(t>0)for(e=t-1;e>0;e--)this.left.unshift(i[e]);if(t<i.length-1)for(e=t+1;e<i.length-1;e++)this.right.push(i[e])}},g={left:[],right:[],leftStepping:0,rightStepping:0,step:function(t,e){var i;if(e.left>0)for(this.leftStepping=Math.floor(t.left.length/e.left),i=t.left[t.left.length-1]+1-this.leftStepping;this.left.length<e.left;i-=this.leftStepping)this.left.unshift(i);if(e.right>0)for(this.rightStepping=Math.floor(t.right.length/e.right),i=t.right[0]-1+this.rightStepping;this.right.length<e.right;i+=this.rightStepping)this.right.push(i)}};n.populate();var r=a(n.left.length,n.right.length),l=h(t+1,e,i.length,r);return g.step(n,l),g.left.unshift(i[0]),g.right.push(i[i.length-1]),t>0&&t+1<i[i.length-1]&&g.left.push(i[t]),g.left.concat(g.right)}function h(t,e,i,n){var g={leftInt:0,leftDec:0,rightInt:0,rightDec:0,left:0,right:0,resWantedPages:1===t||t===i?e-2:e-3,calculate:function(){this.leftInt=l(this.resWantedPages*(n.left/100)).integerVal,this.leftDec=l(this.resWantedPages*(n.left/100)).decimalVal,this.rightInt=l(this.resWantedPages*(n.right/100)).integerVal,this.rightDec=l(this.resWantedPages*(n.right/100)).decimalVal;var t={left:this.leftInt,right:this.rightInt};return t.left+t.right!==this.resWantedPages&&(this.leftDec===this.rightDec?t.left>t.right?t.left++:t.right++:this.leftDec>this.rightDec?t.left++:t.right++),t}};return g.calculate()}function a(t,e){var i={left:0,right:0,ruleOfThree:function(i){return 100*i/(t+e)},define:function(){this.left=this.ruleOfThree(t),this.right=this.ruleOfThree(e)}};return i.define(),i}function l(t){var e={integerVal:0,decimalVal:0,tear:function(){this.integerVal=Math.floor(t),this.decimalVal=t%1}};return e.tear(),e}function f(){e.pages=g(e.total,e.page,e.pageCount,e.pagesLimit)}function s(t){e.pagesLimit=parseInt(n.ngpPagesLimit||7),e.total=parseInt(t.data||0),e.pageCount=parseInt(n.ngpPageCount),f(),n.ngpStartPage&&(e.page=parseInt(n.ngpStartPage)||1,e.page>e.pages.length&&(e.page=e.pages.length),e.page<1&&(e.page=1),console.log("Start page: "+e.page))}function p(t){e.page=t,e.pager(t),f()}function o(){e.page<e.pages[e.pages.length-1]&&p(++e.page)}function u(){e.page>1&&p(--e.page)}function c(){t.get(n.ngpCountUrl).then(s)}e.setPage=p,e.reset=c,e.next=o,e.prev=u,e.page=1,c()}function i(t,e){return e.ngpTemplateUrl}var n={templateUrl:i,link:e,restrict:"A",scope:{pager:"=ngpPager"}};return n}var i=t.angular;i.module("ngPager",[]).directive("ngPager",["$http",e])}(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5nLXBhZ2VyLmpzIl0sIm5hbWVzIjpbIndpbmRvdyIsIm5nUGFnaW5hdGlvbkRpcmVjdGl2ZUZuIiwiJGh0dHAiLCJuZ1BhZ2luYXRpb25EaXJlY3RpdmVMaW5rRm4iLCIkc2NvcGUiLCIkZWxlbWVudCIsIiRhdHRycyIsInBhZ2VyIiwiZWxlbWVudHMiLCJjdXJyZW50UGFnZSIsImVsZW1lbnRzUGVyUGFnZSIsImRpc3BsYXlTaXplIiwiaXNOYU4iLCJjb25zb2xlIiwibG9nIiwicGFnZSIsInBhZ2VzIiwiaSIsImwiLCJNYXRoIiwiZmxvb3IiLCJwdXNoIiwibGVuZ3RoIiwic3RlcHBlZFBhZ2VzIiwicGFnaW5hdGUiLCJjdXJyZW50SW5kZXgiLCJzcGxpdFBhZ2VzIiwibGVmdCIsInJpZ2h0IiwicG9wdWxhdGUiLCJ0aGlzIiwidW5zaGlmdCIsImxlZnRTdGVwcGluZyIsInJpZ2h0U3RlcHBpbmciLCJzdGVwIiwiYmFsYW5jZSIsImJhbGFuY2VQZXJjZW50cyIsInBlcmNlbnQiLCJiYWxhbmNlcyIsImNvbmNhdCIsIndhbnRlZFBhZ2VzIiwibGFzdFBhZ2UiLCJwZXJjZW50YWdlcyIsInBlcmNCYWxhbmNlIiwibGVmdEludCIsImxlZnREZWMiLCJyaWdodEludCIsInJpZ2h0RGVjIiwicmVzV2FudGVkUGFnZXMiLCJjYWxjdWxhdGUiLCJ0ZWFyTnVtYmVyIiwiaW50ZWdlclZhbCIsImRlY2ltYWxWYWwiLCJyZXN1bHRzIiwibGVmdExlbmd0aCIsInJpZ2h0TGVuZ3RoIiwicnVsZU9mVGhyZWUiLCJkZWZpbmUiLCJpbnB1dE51bWJlciIsIm51bWJlciIsInRlYXIiLCJnZW5lcmF0ZVBhZ2VzQXJyYXkiLCJ0b3RhbCIsInBhZ2VDb3VudCIsInBhZ2VzTGltaXQiLCJvbkNvdW50U3VjY2VzcyIsInJlcyIsInBhcnNlSW50IiwibmdwUGFnZXNMaW1pdCIsImRhdGEiLCJuZ3BQYWdlQ291bnQiLCJuZ3BTdGFydFBhZ2UiLCJzZXRQYWdlIiwibmV4dCIsInByZXYiLCJyZXNldCIsImdldCIsIm5ncENvdW50VXJsIiwidGhlbiIsIm5nUGFnaW5hdGlvbkRpcmVjdGl2ZVRlbXBsYXRlVXJsRm4iLCJuZ3BUZW1wbGF0ZVVybCIsIm5nUGFnaW5hdGlvbkRpcmVjdGl2ZURlZiIsInRlbXBsYXRlVXJsIiwibGluayIsInJlc3RyaWN0Iiwic2NvcGUiLCJuZyIsImFuZ3VsYXIiLCJtb2R1bGUiLCJkaXJlY3RpdmUiXSwibWFwcGluZ3MiOiJDQUFDLFNBQVVBLEdBQ1QsWUFTQSxTQUFTQyxHQUF3QkMsR0FNL0IsUUFBU0MsR0FBNEJDLEVBQVFDLEVBQVVDLEdBSXJELFFBQVNDLEdBQU1DLEVBQVVDLEVBQWFDLEVBQWlCQyxHQUNyREQsRUFBbUJFLE1BQU1GLEdBQW9CLEdBQUtBLEVBQ2xEQyxFQUFlQyxNQUFNRCxHQUFnQixFQUFJQSxFQUVuQ0EsRUFBYyxJQUNsQkUsUUFBUUMsSUFBSSwwQkFBNEJILEVBQWMsaUJBQW1CQSxFQUFjLElBQ3ZGQSxJQU1GLEtBQUssR0FIREksR0FBTyxFQUNQQyxLQUVLQyxFQUFJLEVBQUdDLEVBQUlDLEtBQUtDLE1BQU1aLEVBQVdFLEdBQWtCTyxFQUFJQyxFQUFHRCxJQUNqRUQsRUFBTUssT0FBT04sRUFPZixJQUpJUCxFQUFXRSxJQUFvQixHQUNqQ00sRUFBTUssT0FBT04sR0FHWEMsRUFBTU0sT0FBU1gsRUFBYSxDQUM5QixHQUFJWSxHQUFlQyxFQUFTZixFQUFjLEVBQUdFLEVBQWFLLEVBQzFELE9BQU9PLEdBRVAsTUFBT1AsR0FVWCxRQUFTUSxHQUFTQyxFQUFjZCxFQUFhSyxHQUMzQ1MsRUFBZ0JBLEVBQWUsRUFBSyxFQUFJQSxFQUN4Q0EsRUFBZ0JBLEVBQWdCVCxFQUFNTSxPQUFTLEVBQU9OLEVBQU1NLE9BQVMsRUFBS0csQ0FFMUUsSUFBSUMsSUFDRkMsUUFDQUMsU0FFQUMsU0FBVSxXQUNSLEdBQUlaLEVBRUosSUFBSVEsRUFBZSxFQUNqQixJQUFLUixFQUFLUSxFQUFlLEVBQUlSLEVBQUksRUFBR0EsSUFDbENhLEtBQUtI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T3FFLEtBQU9BLEVBQ2RyRSxFQUFPc0UsS0FBT0EsRUFDZHRFLEVBQU9XLEtBQU8sRUFFZDRELElBUUYsUUFBU0ksR0FBbUMxRSxFQUFVQyxHQUNwRCxNQUFPQSxHQUFPMEUsZUFJaEIsR0FBSUMsSUFDRkMsWUFBYUgsRUFFYkksS0FBTWhGLEVBRU5pRixTQUFVLElBRVZDLE9BQ0U5RSxNQUFPLGFBSVgsT0FBTzBFLEdBL1RULEdBQUlLLEdBQUt0RixFQUFPdUYsT0FtVWhCRCxHQUFHRSxPQUFPLGNBR1BDLFVBQVUsV0FDVCxRQUVBeEYsS0FHSkQiLCJmaWxlIjoibmctcGFnZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKHdpbmRvdykge1xuICAndXNlIHN0cmljdCc7XG5cbiAgdmFyIG5nID0gd2luZG93LmFuZ3VsYXI7XG5cbiAgLyoqXG4gICAqIFBhZ2luYXRpb24gZGlyZWN0aXZlIGZ1bmN0aW9uLlxuICAgKlxuICAgKiBAdHlwZSBBbmd1bGFySlMgRGlyZWN0aXZlIEZ1bmN0aW9uXG4gICAqL1xuICBmdW5jdGlvbiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVGbigkaHR0cCkge1xuICAgIC8qKlxuICAgICAqIFBhZ2luYXRpb24gZGlyZWN0aXZlIGxpbmsgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAdHlwZSBBbmd1bGFySlMgRGlyZWN0aXZlIExpbmsgRnVuY3Rpb25cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVMaW5rRm4oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKSB7XG4gICAgICAvKipcbiAgICAgICAqIERJU1BMQVkgU0laRSBNVVNUIEJFIEFOIE9ERCBOVU1CRVIuIElGIElUJ1MgTk9ULCBJVCBXSUxMIEJFIEZPUkNFRCBJTlRPIFRIRSBORVhUIE9ERCBOVU1CRVIgVVBXQVJEUy5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gcGFnZXIoZWxlbWVudHMsIGN1cnJlbnRQYWdlLCBlbGVtZW50c1BlclBhZ2UsIGRpc3BsYXlTaXplKSB7XG4gICAgICAgIGVsZW1lbnRzUGVyUGFnZSA9IChpc05hTihlbGVtZW50c1BlclBhZ2UpKSA/IDEwIDogZWxlbWVudHNQZXJQYWdlO1xuICAgICAgICBkaXNwbGF5U2l6ZSA9IChpc05hTihkaXNwbGF5U2l6ZSkpID8gOSA6IGRpc3BsYXlTaXplO1xuXG4gICAgICAgIGlmICghKGRpc3BsYXlTaXplICUgMikpIHsgLy8gQ2hlY2sgaWYgTk9UIG9kZFxuICAgICAgICAgIGNvbnNvbGUubG9nKCdbSU5GT106IGRpc3BsYXlTaXplIG9mICcgKyBkaXNwbGF5U2l6ZSArICcgZm9yY2VkIGludG8gJyArIChkaXNwbGF5U2l6ZSArIDEpKTtcbiAgICAgICAgICBkaXNwbGF5U2l6ZSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHBhZ2UgPSAwO1xuICAgICAgICB2YXIgcGFnZXMgPSBbXTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IE1hdGguZmxvb3IoZWxlbWVudHMgLyBlbGVtZW50c1BlclBhZ2UpOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgcGFnZXMucHVzaCgrK3BhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVsZW1lbnRzICUgZWxlbWVudHNQZXJQYWdlICE9PSAwKSB7XG4gICAgICAgICAgcGFnZXMucHVzaCgrK3BhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhZ2VzLmxlbmd0aCA+IGRpc3BsYXlTaXplKSB7XG4gICAgICAgICAgdmFyIHN0ZXBwZWRQYWdlcyA9IHBhZ2luYXRlKGN1cnJlbnRQYWdlIC0gMSwgZGlzcGxheVNpemUsIHBhZ2VzKTtcbiAgICAgICAgICByZXR1cm4gc3RlcHBlZFBhZ2VzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBwYWdlcztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIFxuICAgICAgICogQHBhcmFtIHsqfSBjdXJyZW50SW5kZXggXG4gICAgICAgKiBAcGFyYW0geyp9IGRpc3BsYXlTaXplIFxuICAgICAgICogQHBhcmFtIHsqfSBwYWdlcyBcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gcGFnaW5hdGUoY3VycmVudEluZGV4LCBkaXNwbGF5U2l6ZSwgcGFnZXMpIHtcbiAgICAgICAgY3VycmVudEluZGV4ID0gKGN1cnJlbnRJbmRleCA8IDApID8gMCA6IGN1cnJlbnRJbmRleDtcbiAgICAgICAgY3VycmVudEluZGV4ID0gKGN1cnJlbnRJbmRleCA+IChwYWdlcy5sZW5ndGggLSAxKSkgPyAocGFnZXMubGVuZ3RoIC0gMSkgOiBjdXJyZW50SW5kZXg7XG5cbiAgICAgICAgdmFyIHNwbGl0UGFnZXMgPSB7XG4gICAgICAgICAgbGVmdDogW10sXG4gICAgICAgICAgcmlnaHQ6IFtdLFxuXG4gICAgICAgICAgcG9wdWxhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpO1xuXG4gICAgICAgICAgICBpZiAoY3VycmVudEluZGV4ID4gMCkge1xuICAgICAgICAgICAgICBmb3IgKGkgPSAoY3VycmVudEluZGV4IC0gMSk7IGkgPiAwOyBpLS0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxlZnQudW5zaGlmdChwYWdlc1tpXSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRJbmRleCA8IChwYWdlcy5sZW5ndGggLSAxKSkge1xuICAgICAgICAgICAgICBmb3IgKGkgPSAoY3VycmVudEluZGV4ICsgMSk7IGkgPCAocGFnZXMubGVuZ3RoIC0gMSk7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMucmlnaHQucHVzaChwYWdlc1tpXSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHN0ZXBwZWRQYWdlcyA9IHtcbiAgICAgICAgICBsZWZ0OiBbXSxcbiAgICAgICAgICByaWdodDogW10sXG5cbiAgICAgICAgICBsZWZ0U3RlcHBpbmc6IDAsXG4gICAgICAgICAgcmlnaHRTdGVwcGluZzogMCxcblxuICAgICAgICAgIHN0ZXA6IGZ1bmN0aW9uIChzcGxpdFBhZ2VzLCBiYWxhbmNlKSB7XG4gICAgICAgICAgICB2YXIgaTtcblxuICAgICAgICAgICAgaWYgKGJhbGFuY2UubGVmdCA+IDApIHtcbiAgICAgICAgICAgICAgdGhpcy5sZWZ0U3RlcHBpbmcgPSBNYXRoLmZsb29yKHNwbGl0UGFnZXMubGVmdC5sZW5ndGggLyBiYWxhbmNlLmxlZnQpO1xuXG4gICAgICAgICAgICAgIGZvciAoaSA9IChzcGxpdFBhZ2VzLmxlZnRbc3BsaXRQYWdlcy5sZWZ0Lmxlbmd0aCAtIDFdICsgMSkgLSB0aGlzLmxlZnRTdGVwcGluZzsgdGhpcy5sZWZ0Lmxlbmd0aCA8IGJhbGFuY2UubGVmdDsgaSA9IChpIC0gdGhpcy5sZWZ0U3RlcHBpbmcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sZWZ0LnVuc2hpZnQoaSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGJhbGFuY2UucmlnaHQgPiAwKSB7XG4gICAgICAgICAgICAgIHRoaXMucmlnaHRTdGVwcGluZyA9IE1hdGguZmxvb3Ioc3BsaXRQYWdlcy5yaWdodC5sZW5ndGggLyBiYWxhbmNlLnJpZ2h0KTtcblxuICAgICAgICAgICAgICBmb3IgKGkgPSAoc3BsaXRQYWdlcy5yaWdodFswXSAtIDEpICsgdGhpcy5yaWdodFN0ZXBwaW5nOyB0aGlzLnJpZ2h0Lmxlbmd0aCA8IGJhbGFuY2UucmlnaHQ7IGkgPSAoaSArIHRoaXMucmlnaHRTdGVwcGluZykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0LnB1c2goaSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc3BsaXRQYWdlcy5wb3B1bGF0ZSgpO1xuXG4gICAgICAgIHZhciBiYWxhbmNlUGVyY2VudHMgPSBwZXJjZW50KHNwbGl0UGFnZXMubGVmdC5sZW5ndGgsIHNwbGl0UGFnZXMucmlnaHQubGVuZ3RoKTtcblxuICAgICAgICB2YXIgYmFsYW5jZXMgPSBiYWxhbmNlKChjdXJyZW50SW5kZXggKyAxKSwgZGlzcGxheVNpemUsIHBhZ2VzLmxlbmd0aCwgYmFsYW5jZVBlcmNlbnRzKTtcblxuICAgICAgICBzdGVwcGVkUGFnZXMuc3RlcChzcGxpdFBhZ2VzLCBiYWxhbmNlcyk7XG5cbiAgICAgICAgc3RlcHBlZFBhZ2VzLmxlZnQudW5zaGlmdChwYWdlc1swXSk7XG4gICAgICAgIHN0ZXBwZWRQYWdlcy5yaWdodC5wdXNoKHBhZ2VzW3BhZ2VzLmxlbmd0aCAtIDFdKTtcblxuICAgICAgICBpZiAoY3VycmVudEluZGV4ID4gMCAmJiAoY3VycmVudEluZGV4ICsgMSkgPCBwYWdlc1twYWdlcy5sZW5ndGggLSAxXSkge1xuICAgICAgICAgIHN0ZXBwZWRQYWdlcy5sZWZ0LnB1c2gocGFnZXNbY3VycmVudEluZGV4XSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3RlcHBlZFBhZ2VzLmxlZnQuY29uY2F0KHN0ZXBwZWRQYWdlcy5yaWdodCk7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogXG4gICAgICAgKiBAcGFyYW0geyp9IGN1cnJlbnRQYWdlIFxuICAgICAgICogQHBhcmFtIHsqfSB3YW50ZWRQYWdlcyBcbiAgICAgICAqIEBwYXJhbSB7Kn0gbGFzdFBhZ2UgXG4gICAgICAgKiBAcGFyYW0geyp9IHBlcmNlbnRhZ2VzIFxuICAgICAgICogQHJldHVybnMgXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGJhbGFuY2UoY3VycmVudFBhZ2UsIHdhbnRlZFBhZ2VzLCBsYXN0UGFnZSwgcGVyY2VudGFnZXMpIHtcblxuICAgICAgICB2YXIgcGVyY0JhbGFuY2UgPSB7XG4gICAgICAgICAgbGVmdEludDogMCxcbiAgICAgICAgICBsZWZ0RGVjOiAwLFxuXG4gICAgICAgICAgcmlnaHRJbnQ6IDAsXG4gICAgICAgICAgcmlnaHREZWM6IDAsXG5cbiAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgIHJpZ2h0OiAwLFxuXG4gICAgICAgICAgcmVzV2FudGVkUGFnZXM6IChjdXJyZW50UGFnZSA9PT0gMSB8fCBjdXJyZW50UGFnZSA9PT0gbGFzdFBhZ2UpID8gKHdhbnRlZFBhZ2VzIC0gMikgOiAod2FudGVkUGFnZXMgLSAzKSxcblxuICAgICAgICAgIGNhbGN1bGF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5sZWZ0SW50ID0gdGVhck51bWJlcih0aGlzLnJlc1dhbnRlZFBhZ2VzICogKHBlcmNlbnRhZ2VzLmxlZnQgLyAxMDApKS5pbnRlZ2VyVmFsO1xuICAgICAgICAgICAgdGhpcy5sZWZ0RGVjID0gdGVhck51bWJlcih0aGlzLnJlc1dhbnRlZFBhZ2VzICogKHBlcmNlbnRhZ2VzLmxlZnQgLyAxMDApKS5kZWNpbWFsVmFsO1xuXG4gICAgICAgICAgICB0aGlzLnJpZ2h0SW50ID0gdGVhck51bWJlcih0aGlzLnJlc1dhbnRlZFBhZ2VzICogKHBlcmNlbnRhZ2VzLnJpZ2h0IC8gMTAwKSkuaW50ZWdlclZhbDtcbiAgICAgICAgICAgIHRoaXMucmlnaHREZWMgPSB0ZWFyTnVtYmVyKHRoaXMucmVzV2FudGVkUGFnZXMgKiAocGVyY2VudGFnZXMucmlnaHQgLyAxMDApKS5kZWNpbWFsVmFsO1xuXG4gICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHtcbiAgICAgICAgICAgICAgbGVmdDogdGhpcy5sZWZ0SW50LFxuICAgICAgICAgICAgICByaWdodDogdGhpcy5yaWdodEludFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKChyZXN1bHRzLmxlZnQgKyByZXN1bHRzLnJpZ2h0KSAhPT0gdGhpcy5yZXNXYW50ZWRQYWdlcykge1xuICAgICAgICAgICAgICBpZiAodGhpcy5sZWZ0RGVjID09PSB0aGlzLnJpZ2h0RGVjKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdHMubGVmdCA+IHJlc3VsdHMucmlnaHQpIHtcbiAgICAgICAgICAgICAgICAgIHJlc3VsdHMubGVmdCsrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXN1bHRzLnJpZ2h0Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxlZnREZWMgPiB0aGlzLnJpZ2h0RGVjKSB7XG4gICAgICAgICAgICAgICAgICByZXN1bHRzLmxlZnQrKztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmVzdWx0cy5yaWdodCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHBlcmNCYWxhbmNlLmNhbGN1bGF0ZSgpO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIFxuICAgICAgICogQHBhcmFtIHsqfSBsZWZ0TGVuZ3RoIFxuICAgICAgICogQHBhcmFtIHsqfSByaWdodExlbmd0aCBcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gcGVyY2VudChsZWZ0TGVuZ3RoLCByaWdodExlbmd0aCkge1xuXG4gICAgICAgIHZhciBwZXJjZW50YWdlcyA9IHtcbiAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgIHJpZ2h0OiAwLFxuXG4gICAgICAgICAgcnVsZU9mVGhyZWU6IGZ1bmN0aW9uIChsZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiAoMTAwICogbGVuZ3RoKSAvIChsZWZ0TGVuZ3RoICsgcmlnaHRMZW5ndGgpO1xuICAgICAgICAgIH0sXG5cbiAgICAgICAgICBkZWZpbmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMubGVmdCA9IHRoaXMucnVsZU9mVGhyZWUobGVmdExlbmd0aCk7XG4gICAgICAgICAgICB0aGlzLnJpZ2h0ID0gdGhpcy5ydWxlT2ZUaHJlZShyaWdodExlbmd0aCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHBlcmNlbnRhZ2VzLmRlZmluZSgpO1xuXG4gICAgICAgIHJldHVybiBwZXJjZW50YWdlcztcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gdGVhck51bWJlcihpbnB1dE51bWJlcikge1xuXG4gICAgICAgIHZhciBudW1iZXIgPSB7XG4gICAgICAgICAgaW50ZWdlclZhbDogMCxcbiAgICAgICAgICBkZWNpbWFsVmFsOiAwLFxuXG4gICAgICAgICAgdGVhcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5pbnRlZ2VyVmFsID0gTWF0aC5mbG9vcihpbnB1dE51bWJlcik7XG4gICAgICAgICAgICB0aGlzLmRlY2ltYWxWYWwgPSAoaW5wdXROdW1iZXIgJSAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgbnVtYmVyLnRlYXIoKTtcblxuICAgICAgICByZXR1cm4gbnVtYmVyO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZW5lcmF0ZVBhZ2VzQXJyYXkoKSB7XG4gICAgICAgICRzY29wZS5wYWdlcyA9IHBhZ2VyKCRzY29wZS50b3RhbCwgJHNjb3BlLnBhZ2UsICRzY29wZS5wYWdlQ291bnQsICRzY29wZS5wYWdlc0xpbWl0KTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBPbiBjb3VudCByZXF1ZXN0IHN1Y2Nlc3MuXG4gICAgICAgKlxuICAgICAgICogQHR5cGUgJGh0dHAgdGhlbiBjYWxsYmFjay5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gb25Db3VudFN1Y2Nlc3MocmVzKSB7XG4gICAgICAgICRzY29wZS5wYWdlc0xpbWl0ID0gcGFyc2VJbnQoJGF0dHJzLm5ncFBhZ2VzTGltaXQgfHwgNyk7XG4gICAgICAgICRzY29wZS50b3RhbCA9IHBhcnNlSW50KHJlcy5kYXRhIHx8IDApO1xuICAgICAgICAkc2NvcGUucGFnZUNvdW50ID0gcGFyc2VJbnQoJGF0dHJzLm5ncFBhZ2VDb3VudCk7XG4gICAgICAgIFxuICAgICAgICBnZW5lcmF0ZVBhZ2VzQXJyYXkoKTtcblxuICAgICAgICBpZiAoJGF0dHJzLm5ncFN0YXJ0UGFnZSkge1xuICAgICAgICAgICRzY29wZS5wYWdlID0gcGFyc2VJbnQoJGF0dHJzLm5ncFN0YXJ0UGFnZSkgfHwgMTtcblxuICAgICAgICAgIGlmICgkc2NvcGUucGFnZSA+ICRzY29wZS5wYWdlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICRzY29wZS5wYWdlID0gJHNjb3BlLnBhZ2VzLmxlbmd0aDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoJHNjb3BlLnBhZ2UgPCAxKSB7XG4gICAgICAgICAgICAkc2NvcGUucGFnZSA9IDE7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc29sZS5sb2coJ1N0YXJ0IHBhZ2U6ICcgKyAkc2NvcGUucGFnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBTZXRzIHRoZSBjdXJyZW50IHBhZ2UuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHBhZ2UgVGhlIHBhZ2UgbnVtYmVyIHRvIHNldC5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gc2V0UGFnZShwYWdlKSB7XG4gICAgICAgICRzY29wZS5wYWdlID0gcGFnZTtcbiAgICAgICAgJHNjb3BlLnBhZ2VyKHBhZ2UpO1xuXG4gICAgICAgIGdlbmVyYXRlUGFnZXNBcnJheSgpO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIEdvZXMgdG8gdGhlIG5leHQgcGFnZS5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgaWYgKCRzY29wZS5wYWdlIDwgJHNjb3BlLnBhZ2VzWyRzY29wZS5wYWdlcy5sZW5ndGggLSAxXSkge1xuICAgICAgICAgIHNldFBhZ2UoKyskc2NvcGUucGFnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBHb2VzIHRvIHRoZSBwcmV2aW91cyBwYWdlLlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBwcmV2KCkge1xuICAgICAgICBpZiAoJHNjb3BlLnBhZ2UgPiAxKSB7XG4gICAgICAgICAgc2V0UGFnZSgtLSRzY29wZS5wYWdlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgICAgJGh0dHAuZ2V0KCRhdHRycy5uZ3BDb3VudFVybClcbiAgICAgICAgICAudGhlbihvbkNvdW50U3VjY2Vzcyk7XG4gICAgICB9XG5cbiAgICAgICRzY29wZS5zZXRQYWdlID0gc2V0UGFnZTtcbiAgICAgICRzY29wZS5yZXNldCA9IHJlc2V0O1xuICAgICAgJHNjb3BlLm5leHQgPSBuZXh0O1xuICAgICAgJHNjb3BlLnByZXYgPSBwcmV2O1xuICAgICAgJHNjb3BlLnBhZ2UgPSAxO1xuXG4gICAgICByZXNldCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhZ2luYXRpb24gZGlyZWN0aXZlIHRlbXBsYXRlIFVSTCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEB0eXBlIEFuZ3VsYXJKUyBEaXJlY3RpdmUgVGVtcGxhdGUgVVJMIEZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZVRlbXBsYXRlVXJsRm4oJGVsZW1lbnQsICRhdHRycykge1xuICAgICAgcmV0dXJuICRhdHRycy5uZ3BUZW1wbGF0ZVVybDtcbiAgICB9XG5cbiAgICAvKiBQYWdpbmF0aW9uIGRpcmVjdGl2ZSBkZWZpbml0aW9uICovXG4gICAgdmFyIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZURlZiA9IHtcbiAgICAgIHRlbXBsYXRlVXJsOiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVUZW1wbGF0ZVVybEZuLFxuXG4gICAgICBsaW5rOiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVMaW5rRm4sXG5cbiAgICAgIHJlc3RyaWN0OiAnQScsXG5cbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHBhZ2VyOiAnPW5ncFBhZ2VyJ1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gbmdQYWdpbmF0aW9uRGlyZWN0aXZlRGVmO1xuICB9XG5cbiAgLyogRGVmaW5lIHRoZSBBbmd1bGFySlMgbW9kdWxlICovXG4gIG5nLm1vZHVsZSgnbmdQYWdlcicsIFtdKVxuXG4gICAgLyogRGVmaW5lIHRoZSBBbmd1bGFySlMgZGlyZWN0aXZlICovXG4gICAgLmRpcmVjdGl2ZSgnbmdQYWdlcicsIFtcbiAgICAgICckaHR0cCcsXG5cbiAgICAgIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZUZuXG4gICAgXSk7XG5cbn0od2luZG93KSk7Il19
