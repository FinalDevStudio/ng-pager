!function(t){"use strict";function e(t){function e(e,i,n){function r(t){var e={integerVal:0,decimalVal:0,tear:function(){this.integerVal=Math.floor(t),this.decimalVal=t%1}};return e.tear(),e}function g(t,e){var i={left:0,right:0,ruleOfThirds:function(i){return 100*i/(t+e)},define:function(){this.left=this.ruleOfThirds(t),this.right=this.ruleOfThirds(e)}};return i.define(),i}function h(t,e,i,n){var g={leftInt:0,leftDec:0,rightInt:0,rightDec:0,left:0,right:0,resWantedPages:1===t||t===i?e-2:e-3,calculate:function(){this.leftInt=r(this.resWantedPages*(n.left/100)).integerVal,this.leftDec=r(this.resWantedPages*(n.left/100)).decimalVal,this.rightInt=r(this.resWantedPages*(n.right/100)).integerVal,this.rightDec=r(this.resWantedPages*(n.right/100)).decimalVal;var t={left:this.leftInt,right:this.rightInt};return t.left+t.right!==this.resWantedPages&&(this.leftDec===this.rightDec?t.left>t.right?t.left++:t.right++:this.leftDec>this.rightDec?t.left++:t.right++),t}};return g.calculate()}function a(t,e,i){t=t<0?0:t,t=t>i.length-1?i.length-1:t;var n={left:[],right:[],populate:function(){if(t>0)for(var e=t-1;e>0;e--)this.left.unshift(i[e]);if(t<i.length-1)for(var n=t+1;n<i.length-1;n++)this.right.push(i[n])}},r={left:[],right:[],leftStepping:0,rightStepping:0,step:function(t,e){if(e.left>0){this.leftStepping=Math.floor(t.left.length/e.left);for(var i=t.left[t.left.length-1]+1-this.leftStepping;this.left.length<e.left;i-=this.leftStepping)this.left.unshift(i)}if(e.right>0){this.rightStepping=Math.floor(t.right.length/e.right);for(var n=t.right[0]-1+this.rightStepping;this.right.length<e.right;n+=this.rightStepping)this.right.push(n)}}};n.populate();var a=g(n.left.length,n.right.length),l=h(t+1,e,i.length,a);return r.step(n,l),r.left.unshift(i[0]),r.right.push(i[i.length-1]),t>0&&t<i[i.length]&&r.left.push(i[t]),r.left.concat(r.right)}function l(t,e,i,n){i=isNaN(i)?10:i,n=isNaN(n)?9:n,n%2||(console.log("[INFO]: displaySize of "+n+" forced into "+(n+1)),n++);for(var r=0,g=[],h=0,l=Math.floor(t/i);h<l;h++)g.push(++r);if(t%i!==0&&g.push(++r),g.length>n){var f=a(e-1,n,g);return f}return g}function f(t){e.total=parseInt(t.data||0),e.pageCount=parseInt(n.ngpPageCount),e.pages=l(e.total,e.page,e.pageCount),n.ngpStartPage&&(e.page=parseInt(n.ngpStartPage)||1,e.page>e.pages.length&&(e.page=e.pages.length),e.page<1&&(e.page=1),console.log("Start page: "+e.page))}function s(t){e.page=t,e.pager(t)}function p(){e.page<e.pages.length&&s(++e.page)}function o(){e.page>1&&s(--e.page)}function u(){t.get(n.ngpCountUrl).then(f)}e.setPage=s,e.reset=u,e.next=p,e.prev=o,e.page=1,u()}function i(t,e){return e.ngpTemplateUrl}var n={templateUrl:i,link:e,restrict:"A",scope:{pager:"=ngpPager"}};return n}var i=t.angular;i.module("ngPager",[]).directive("ngPager",["$http",e])}(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5nLXBhZ2VyLmpzIl0sIm5hbWVzIjpbIndpbmRvdyIsIm5nUGFnaW5hdGlvbkRpcmVjdGl2ZUZuIiwiJGh0dHAiLCJuZ1BhZ2luYXRpb25EaXJlY3RpdmVMaW5rRm4iLCIkc2NvcGUiLCIkZWxlbWVudCIsIiRhdHRycyIsInRlYXJOdW1iZXIiLCJpbnB1dE51bWJlciIsIm51bWJlciIsImludGVnZXJWYWwiLCJkZWNpbWFsVmFsIiwidGVhciIsInRoaXMiLCJNYXRoIiwiZmxvb3IiLCJwZXJjZW50IiwibGVmdExlbmd0aCIsInJpZ2h0TGVuZ3RoIiwicGVyY2VudGFnZXMiLCJsZWZ0IiwicmlnaHQiLCJydWxlT2ZUaGlyZHMiLCJsZW5ndGgiLCJkZWZpbmUiLCJiYWxhbmNlIiwiY3VycmVudFBhZ2UiLCJ3YW50ZWRQYWdlcyIsImxhc3RQYWdlIiwicGVyY0JhbGFuY2UiLCJsZWZ0SW50IiwibGVmdERlYyIsInJpZ2h0SW50IiwicmlnaHREZWMiLCJyZXNXYW50ZWRQYWdlcyIsImNhbGN1bGF0ZSIsInJlc3VsdHMiLCJwYWdpbmF0ZSIsImN1cnJlbnRJbmRleCIsImRpc3BsYXlTaXplIiwicGFnZXMiLCJzcGxpdFBhZ2VzIiwicG9wdWxhdGUiLCJpIiwidW5zaGlmdCIsImoiLCJwdXNoIiwic3RlcHBlZFBhZ2VzIiwibGVmdFN0ZXBwaW5nIiwicmlnaHRTdGVwcGluZyIsInN0ZXAiLCJiYWxhbmNlUGVyY2VudHMiLCJiYWxhbmNlcyIsImNvbmNhdCIsInBhZ2VyIiwiZWxlbWVudHMiLCJlbGVtZW50c1BlclBhZ2UiLCJpc05hTiIsImNvbnNvbGUiLCJsb2ciLCJwYWdlIiwibCIsIm9uQ291bnRTdWNjZXNzIiwicmVzIiwidG90YWwiLCJwYXJzZUludCIsImRhdGEiLCJwYWdlQ291bnQiLCJuZ3BQYWdlQ291bnQiLCJuZ3BTdGFydFBhZ2UiLCJzZXRQYWdlIiwibmV4dCIsInByZXYiLCJyZXNldCIsImdldCIsIm5ncENvdW50VXJsIiwidGhlbiIsIm5nUGFnaW5hdGlvbkRpcmVjdGl2ZVRlbXBsYXRlVXJsRm4iLCJuZ3BUZW1wbGF0ZVVybCIsIm5nUGFnaW5hdGlvbkRpcmVjdGl2ZURlZiIsInRlbXBsYXRlVXJsIiwibGluayIsInJlc3RyaWN0Iiwic2NvcGUiLCJuZyIsImFuZ3VsYXIiLCJtb2R1bGUiLCJkaXJlY3RpdmUiXSwibWFwcGluZ3MiOiJDQUFDLFNBQVVBLEdBQ1QsWUFTQSxTQUFTQyxHQUF3QkMsR0FNL0IsUUFBU0MsR0FBNEJDLEVBQVFDLEVBQVVDLEdBQ3JELFFBQVNDLEdBQVdDLEdBQ2xCLEdBQUlDLElBQ0ZDLFdBQVksRUFDWkMsV0FBWSxFQUVaQyxLQUFNLFdBQ0pDLEtBQUtILFdBQWFJLEtBQUtDLE1BQU1QLEdBQzdCSyxLQUFLRixXQUFjSCxFQUFjLEdBTXJDLE9BRkFDLEdBQU9HLE9BRUFILEVBR1QsUUFBU08sR0FBUUMsRUFBWUMsR0FDM0IsR0FBSUMsSUFDRkMsS0FBTSxFQUNOQyxNQUFPLEVBRVBDLGFBQWMsU0FBVUMsR0FDdEIsTUFBUSxLQUFNQSxHQUFXTixFQUFhQyxJQUd4Q00sT0FBUSxXQUNOWCxLQUFLTyxLQUFPUCxLQUFLUyxhQUFhTCxHQUM5QkosS0FBS1EsTUFBUVIsS0FBS1MsYUFBYUosSUFNbkMsT0FGQUMsR0FBWUssU0FFTEwsRUFHVCxRQUFTTSxHQUFRQyxFQUFhQyxFQUFhQyxFQUFVVCxHQUNuRCxHQUFJVSxJQUNGQyxRQUFTLEVBQ1RDLFFBQVMsRUFFVEMsU0FBVSxFQUNWQyxTQUFVLEVBRVZiLEtBQU0sRUFDTkMsTUFBTyxFQUVQYSxlQUFpQyxJQUFoQlIsR0FBcUJBLElBQWdCRSxFQUFhRCxFQUFjLEVBQU1BLEVBQWMsRUFFckdRLFVBQVcsV0FDVHRCLEtBQUtpQixRQUFVdkIsRUFBV00sS0FBS3FCLGdCQUFrQmYsRUFBWUMsS0FBTyxNQUFNVixXQUMxRUcsS0FBS2tCLFFBQVV4QixFQUFXTSxLQUFLcUIsZ0JBQWtCZixFQUFZQyxLQUFPLE1BQU1ULFdBRTFFRSxLQUFLbUIsU0FBV3pCLEVBQVdNLEtBQUtx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U0ksR0FBbUN4RSxFQUFVQyxHQUNwRCxNQUFPQSxHQUFPd0UsZUFJaEIsR0FBSUMsSUFDRkMsWUFBYUgsRUFFYkksS0FBTTlFLEVBRU4rRSxTQUFVLElBRVZDLE9BQ0U3QixNQUFPLGFBSVgsT0FBT3lCLEdBelJULEdBQUlLLEdBQUtwRixFQUFPcUYsT0E2UmhCRCxHQUFHRSxPQUFPLGNBR1BDLFVBQVUsV0FDVCxRQUVBdEYsS0FHSkQiLCJmaWxlIjoibmctcGFnZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKHdpbmRvdykge1xuICAndXNlIHN0cmljdCc7XG5cbiAgdmFyIG5nID0gd2luZG93LmFuZ3VsYXI7XG5cbiAgLyoqXG4gICAqIFBhZ2luYXRpb24gZGlyZWN0aXZlIGZ1bmN0aW9uLlxuICAgKlxuICAgKiBAdHlwZSBBbmd1bGFySlMgRGlyZWN0aXZlIEZ1bmN0aW9uXG4gICAqL1xuICBmdW5jdGlvbiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVGbigkaHR0cCkge1xuICAgIC8qKlxuICAgICAqIFBhZ2luYXRpb24gZGlyZWN0aXZlIGxpbmsgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAdHlwZSBBbmd1bGFySlMgRGlyZWN0aXZlIExpbmsgRnVuY3Rpb25cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVMaW5rRm4oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzKSB7XG4gICAgICBmdW5jdGlvbiB0ZWFyTnVtYmVyKGlucHV0TnVtYmVyKSB7XG4gICAgICAgIHZhciBudW1iZXIgPSB7XG4gICAgICAgICAgaW50ZWdlclZhbDogMCxcbiAgICAgICAgICBkZWNpbWFsVmFsOiAwLFxuXG4gICAgICAgICAgdGVhcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5pbnRlZ2VyVmFsID0gTWF0aC5mbG9vcihpbnB1dE51bWJlcik7XG4gICAgICAgICAgICB0aGlzLmRlY2ltYWxWYWwgPSAoaW5wdXROdW1iZXIgJSAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgbnVtYmVyLnRlYXIoKTtcblxuICAgICAgICByZXR1cm4gbnVtYmVyO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBwZXJjZW50KGxlZnRMZW5ndGgsIHJpZ2h0TGVuZ3RoKSB7XG4gICAgICAgIHZhciBwZXJjZW50YWdlcyA9IHtcbiAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgIHJpZ2h0OiAwLFxuXG4gICAgICAgICAgcnVsZU9mVGhpcmRzOiBmdW5jdGlvbiAobGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gKDEwMCAqIGxlbmd0aCkgLyAobGVmdExlbmd0aCArIHJpZ2h0TGVuZ3RoKTtcbiAgICAgICAgICB9LFxuXG4gICAgICAgICAgZGVmaW5lOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmxlZnQgPSB0aGlzLnJ1bGVPZlRoaXJkcyhsZWZ0TGVuZ3RoKTtcbiAgICAgICAgICAgIHRoaXMucmlnaHQgPSB0aGlzLnJ1bGVPZlRoaXJkcyhyaWdodExlbmd0aCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHBlcmNlbnRhZ2VzLmRlZmluZSgpO1xuXG4gICAgICAgIHJldHVybiBwZXJjZW50YWdlcztcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gYmFsYW5jZShjdXJyZW50UGFnZSwgd2FudGVkUGFnZXMsIGxhc3RQYWdlLCBwZXJjZW50YWdlcykge1xuICAgICAgICB2YXIgcGVyY0JhbGFuY2UgPSB7XG4gICAgICAgICAgbGVmdEludDogMCxcbiAgICAgICAgICBsZWZ0RGVjOiAwLFxuXG4gICAgICAgICAgcmlnaHRJbnQ6IDAsXG4gICAgICAgICAgcmlnaHREZWM6IDAsXG5cbiAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgIHJpZ2h0OiAwLFxuXG4gICAgICAgICAgcmVzV2FudGVkUGFnZXM6IChjdXJyZW50UGFnZSA9PT0gMSB8fCBjdXJyZW50UGFnZSA9PT0gbGFzdFBhZ2UpID8gKHdhbnRlZFBhZ2VzIC0gMikgOiAod2FudGVkUGFnZXMgLSAzKSxcblxuICAgICAgICAgIGNhbGN1bGF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5sZWZ0SW50ID0gdGVhck51bWJlcih0aGlzLnJlc1dhbnRlZFBhZ2VzICogKHBlcmNlbnRhZ2VzLmxlZnQgLyAxMDApKS5pbnRlZ2VyVmFsO1xuICAgICAgICAgICAgdGhpcy5sZWZ0RGVjID0gdGVhck51bWJlcih0aGlzLnJlc1dhbnRlZFBhZ2VzICogKHBlcmNlbnRhZ2VzLmxlZnQgLyAxMDApKS5kZWNpbWFsVmFsO1xuXG4gICAgICAgICAgICB0aGlzLnJpZ2h0SW50ID0gdGVhck51bWJlcih0aGlzLnJlc1dhbnRlZFBhZ2VzICogKHBlcmNlbnRhZ2VzLnJpZ2h0IC8gMTAwKSkuaW50ZWdlclZhbDtcbiAgICAgICAgICAgIHRoaXMucmlnaHREZWMgPSB0ZWFyTnVtYmVyKHRoaXMucmVzV2FudGVkUGFnZXMgKiAocGVyY2VudGFnZXMucmlnaHQgLyAxMDApKS5kZWNpbWFsVmFsO1xuXG4gICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHtcbiAgICAgICAgICAgICAgbGVmdDogdGhpcy5sZWZ0SW50LFxuICAgICAgICAgICAgICByaWdodDogdGhpcy5yaWdodEludFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKChyZXN1bHRzLmxlZnQgKyByZXN1bHRzLnJpZ2h0KSAhPT0gdGhpcy5yZXNXYW50ZWRQYWdlcykge1xuICAgICAgICAgICAgICBpZiAodGhpcy5sZWZ0RGVjID09PSB0aGlzLnJpZ2h0RGVjKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdHMubGVmdCA+IHJlc3VsdHMucmlnaHQpIHtcbiAgICAgICAgICAgICAgICAgIHJlc3VsdHMubGVmdCsrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICByZXN1bHRzLnJpZ2h0Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxlZnREZWMgPiB0aGlzLnJpZ2h0RGVjKSB7XG4gICAgICAgICAgICAgICAgICByZXN1bHRzLmxlZnQrKztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmVzdWx0cy5yaWdodCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHBlcmNCYWxhbmNlLmNhbGN1bGF0ZSgpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBwYWdpbmF0ZShjdXJyZW50SW5kZXgsIGRpc3BsYXlTaXplLCBwYWdlcykge1xuICAgICAgICBjdXJyZW50SW5kZXggPSAoY3VycmVudEluZGV4IDwgMCkgPyAwIDogY3VycmVudEluZGV4O1xuICAgICAgICBjdXJyZW50SW5kZXggPSAoY3VycmVudEluZGV4ID4gKHBhZ2VzLmxlbmd0aCAtIDEpKSA/IChwYWdlcy5sZW5ndGggLSAxKSA6IGN1cnJlbnRJbmRleDtcblxuICAgICAgICB2YXIgc3BsaXRQYWdlcyA9IHtcbiAgICAgICAgICBsZWZ0OiBbXSxcbiAgICAgICAgICByaWdodDogW10sXG5cbiAgICAgICAgICBwb3B1bGF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IChjdXJyZW50SW5kZXggLSAxKTsgaSA+IDA7IGktLSkge1xuICAgICAgICAgICAgICAgIHRoaXMubGVmdC51bnNoaWZ0KHBhZ2VzW2ldKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY3VycmVudEluZGV4IDwgKHBhZ2VzLmxlbmd0aCAtIDEpKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGogPSAoY3VycmVudEluZGV4ICsgMSk7IGogPCAocGFnZXMubGVuZ3RoIC0gMSk7IGorKykge1xuICAgICAgICAgICAgICAgIHRoaXMucmlnaHQucHVzaChwYWdlc1tqXSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHN0ZXBwZWRQYWdlcyA9IHtcbiAgICAgICAgICBsZWZ0OiBbXSxcbiAgICAgICAgICByaWdodDogW10sXG5cbiAgICAgICAgICBsZWZ0U3RlcHBpbmc6IDAsXG4gICAgICAgICAgcmlnaHRTdGVwcGluZzogMCxcblxuICAgICAgICAgIHN0ZXA6IGZ1bmN0aW9uIChzcGxpdFBhZ2VzLCBiYWxhbmNlKSB7XG4gICAgICAgICAgICBpZiAoYmFsYW5jZS5sZWZ0ID4gMCkge1xuICAgICAgICAgICAgICB0aGlzLmxlZnRTdGVwcGluZyA9IE1hdGguZmxvb3Ioc3BsaXRQYWdlcy5sZWZ0Lmxlbmd0aCAvIGJhbGFuY2UubGVmdCk7XG4gICAgICAgICAgICAgIGZvciAodmFyIGkgPSAoc3BsaXRQYWdlcy5sZWZ0W3NwbGl0UGFnZXMubGVmdC5sZW5ndGggLSAxXSArIDEpIC0gdGhpcy5sZWZ0U3RlcHBpbmc7IHRoaXMubGVmdC5sZW5ndGggPCBiYWxhbmNlLmxlZnQ7IGkgPSAoaSAtIHRoaXMubGVmdFN0ZXBwaW5nKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubGVmdC51bnNoaWZ0KGkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChiYWxhbmNlLnJpZ2h0ID4gMCkge1xuICAgICAgICAgICAgICB0aGlzLnJpZ2h0U3RlcHBpbmcgPSBNYXRoLmZsb29yKHNwbGl0UGFnZXMucmlnaHQubGVuZ3RoIC8gYmFsYW5jZS5yaWdodCk7XG4gICAgICAgICAgICAgIGZvciAodmFyIGogPSAoc3BsaXRQYWdlcy5yaWdodFswXSAtIDEpICsgdGhpcy5yaWdodFN0ZXBwaW5nOyB0aGlzLnJpZ2h0Lmxlbmd0aCA8IGJhbGFuY2UucmlnaHQ7IGogPSAoaiArIHRoaXMucmlnaHRTdGVwcGluZykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0LnB1c2goaik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc3BsaXRQYWdlcy5wb3B1bGF0ZSgpO1xuXG4gICAgICAgIHZhciBiYWxhbmNlUGVyY2VudHMgPSBwZXJjZW50KHNwbGl0UGFnZXMubGVmdC5sZW5ndGgsIHNwbGl0UGFnZXMucmlnaHQubGVuZ3RoKTtcbiAgICAgICAgdmFyIGJhbGFuY2VzID0gYmFsYW5jZSgoY3VycmVudEluZGV4ICsgMSksIGRpc3BsYXlTaXplLCBwYWdlcy5sZW5ndGgsIGJhbGFuY2VQZXJjZW50cyk7XG5cbiAgICAgICAgc3RlcHBlZFBhZ2VzLnN0ZXAoc3BsaXRQYWdlcywgYmFsYW5jZXMpO1xuXG4gICAgICAgIHN0ZXBwZWRQYWdlcy5sZWZ0LnVuc2hpZnQocGFnZXNbMF0pO1xuICAgICAgICBzdGVwcGVkUGFnZXMucmlnaHQucHVzaChwYWdlc1twYWdlcy5sZW5ndGggLSAxXSk7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRJbmRleCA+IDAgJiYgY3VycmVudEluZGV4IDwgcGFnZXNbcGFnZXMubGVuZ3RoXSkge1xuICAgICAgICAgIHN0ZXBwZWRQYWdlcy5sZWZ0LnB1c2gocGFnZXNbY3VycmVudEluZGV4XSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3RlcHBlZFBhZ2VzLmxlZnQuY29uY2F0KHN0ZXBwZWRQYWdlcy5yaWdodCk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHBhZ2VyKGVsZW1lbnRzLCBjdXJyZW50UGFnZSwgZWxlbWVudHNQZXJQYWdlLCBkaXNwbGF5U2l6ZSkge1xuXG4gICAgICAgIGVsZW1lbnRzUGVyUGFnZSA9IChpc05hTihlbGVtZW50c1BlclBhZ2UpKSA/IDEwIDogZWxlbWVudHNQZXJQYWdlO1xuICAgICAgICBkaXNwbGF5U2l6ZSA9IChpc05hTihkaXNwbGF5U2l6ZSkpID8gOSA6IGRpc3BsYXlTaXplO1xuXG4gICAgICAgIGlmICghKGRpc3BsYXlTaXplICUgMikpIHsgLy8gQ2hlY2sgaWYgTk9UIG9kZFxuICAgICAgICAgIGNvbnNvbGUubG9nKCdbSU5GT106IGRpc3BsYXlTaXplIG9mICcgKyBkaXNwbGF5U2l6ZSArICcgZm9yY2VkIGludG8gJyArIChkaXNwbGF5U2l6ZSArIDEpKTtcbiAgICAgICAgICBkaXNwbGF5U2l6ZSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHBhZ2UgPSAwO1xuICAgICAgICB2YXIgcGFnZXMgPSBbXTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IE1hdGguZmxvb3IoZWxlbWVudHMgLyBlbGVtZW50c1BlclBhZ2UpOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgcGFnZXMucHVzaCgrK3BhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVsZW1lbnRzICUgZWxlbWVudHNQZXJQYWdlICE9PSAwKSB7XG4gICAgICAgICAgcGFnZXMucHVzaCgrK3BhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBhZ2VzLmxlbmd0aCA+IGRpc3BsYXlTaXplKSB7XG4gICAgICAgICAgdmFyIHN0ZXBwZWRQYWdlcyA9IHBhZ2luYXRlKGN1cnJlbnRQYWdlIC0gMSwgZGlzcGxheVNpemUsIHBhZ2VzKTtcbiAgICAgICAgICByZXR1cm4gc3RlcHBlZFBhZ2VzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBwYWdlcztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIE9uIGNvdW50IHJlcXVlc3Qgc3VjY2Vzcy5cbiAgICAgICAqXG4gICAgICAgKiBAdHlwZSAkaHR0cCB0aGVuIGNhbGxiYWNrLlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBvbkNvdW50U3VjY2VzcyhyZXMpIHtcbiAgICAgICAgJHNjb3BlLnRvdGFsID0gcGFyc2VJbnQocmVzLmRhdGEgfHwgMCk7XG4gICAgICAgICRzY29wZS5wYWdlQ291bnQgPSBwYXJzZUludCgkYXR0cnMubmdwUGFnZUNvdW50KTtcbiAgICAgICAgJHNjb3BlLnBhZ2VzID0gcGFnZXIoJHNjb3BlLnRvdGFsLCAkc2NvcGUucGFnZSwgJHNjb3BlLnBhZ2VDb3VudCk7XG4gICAgICAgIC8vJHNjb3BlLnBhZ2VzID0gbmV3IEFycmF5KE1hdGguY2VpbCgkc2NvcGUudG90YWwgLyAkc2NvcGUucGFnZUNvdW50KSk7XG5cbiAgICAgICAgaWYgKCRhdHRycy5uZ3BTdGFydFBhZ2UpIHtcbiAgICAgICAgICAkc2NvcGUucGFnZSA9IHBhcnNlSW50KCRhdHRycy5uZ3BTdGFydFBhZ2UpIHx8IDE7XG5cbiAgICAgICAgICBpZiAoJHNjb3BlLnBhZ2UgPiAkc2NvcGUucGFnZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAkc2NvcGUucGFnZSA9ICRzY29wZS5wYWdlcy5sZW5ndGg7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCRzY29wZS5wYWdlIDwgMSkge1xuICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAxO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnNvbGUubG9nKCdTdGFydCBwYWdlOiAnICsgJHNjb3BlLnBhZ2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogU2V0cyB0aGUgY3VycmVudCBwYWdlLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBwYWdlIFRoZSBwYWdlIG51bWJlciB0byBzZXQuXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIHNldFBhZ2UocGFnZSkge1xuICAgICAgICAkc2NvcGUucGFnZSA9IHBhZ2U7XG4gICAgICAgICRzY29wZS5wYWdlcihwYWdlKTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBHb2VzIHRvIHRoZSBuZXh0IHBhZ2UuXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgIGlmICgkc2NvcGUucGFnZSA8ICRzY29wZS5wYWdlcy5sZW5ndGgpIHtcbiAgICAgICAgICBzZXRQYWdlKCsrJHNjb3BlLnBhZ2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogR29lcyB0byB0aGUgcHJldmlvdXMgcGFnZS5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gcHJldigpIHtcbiAgICAgICAgaWYgKCRzY29wZS5wYWdlID4gMSkge1xuICAgICAgICAgIHNldFBhZ2UoLS0kc2NvcGUucGFnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gcmVzZXQoKSB7XG4gICAgICAgICRodHRwLmdldCgkYXR0cnMubmdwQ291bnRVcmwpXG4gICAgICAgICAgLnRoZW4ob25Db3VudFN1Y2Nlc3MpO1xuICAgICAgfVxuXG4gICAgICAkc2NvcGUuc2V0UGFnZSA9IHNldFBhZ2U7XG4gICAgICAkc2NvcGUucmVzZXQgPSByZXNldDtcbiAgICAgICRzY29wZS5uZXh0ID0gbmV4dDtcbiAgICAgICRzY29wZS5wcmV2ID0gcHJldjtcbiAgICAgICRzY29wZS5wYWdlID0gMTtcblxuICAgICAgcmVzZXQoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYWdpbmF0aW9uIGRpcmVjdGl2ZSB0ZW1wbGF0ZSBVUkwgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAdHlwZSBBbmd1bGFySlMgRGlyZWN0aXZlIFRlbXBsYXRlIFVSTCBGdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVUZW1wbGF0ZVVybEZuKCRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICAgIHJldHVybiAkYXR0cnMubmdwVGVtcGxhdGVVcmw7XG4gICAgfVxuXG4gICAgLyogUGFnaW5hdGlvbiBkaXJlY3RpdmUgZGVmaW5pdGlvbiAqL1xuICAgIHZhciBuZ1BhZ2luYXRpb25EaXJlY3RpdmVEZWYgPSB7XG4gICAgICB0ZW1wbGF0ZVVybDogbmdQYWdpbmF0aW9uRGlyZWN0aXZlVGVtcGxhdGVVcmxGbixcblxuICAgICAgbGluazogbmdQYWdpbmF0aW9uRGlyZWN0aXZlTGlua0ZuLFxuXG4gICAgICByZXN0cmljdDogJ0EnLFxuXG4gICAgICBzY29wZToge1xuICAgICAgICBwYWdlcjogJz1uZ3BQYWdlcidcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZURlZjtcbiAgfVxuXG4gIC8qIERlZmluZSB0aGUgQW5ndWxhckpTIG1vZHVsZSAqL1xuICBuZy5tb2R1bGUoJ25nUGFnZXInLCBbXSlcblxuICAgIC8qIERlZmluZSB0aGUgQW5ndWxhckpTIGRpcmVjdGl2ZSAqL1xuICAgIC5kaXJlY3RpdmUoJ25nUGFnZXInLCBbXG4gICAgICAnJGh0dHAnLFxuXG4gICAgICBuZ1BhZ2luYXRpb25EaXJlY3RpdmVGblxuICAgIF0pO1xuXG59KHdpbmRvdykpOyJdfQ==
