!function(t){"use strict";function e(t){function e(e,n,a){function g(t){e.total=parseInt(t.data||0),e.pageCount=parseInt(a.ngpPageCount),e.pages=i(),console.log("PAGES:",e.pages),a.ngpStartPage&&(e.page=parseInt(a.ngpStartPage)||1,e.page>e.pages.length&&(e.page=e.pages.length),e.page<1&&(e.page=1),console.log("Start page: "+e.page))}function r(t){e.page=t,e.pager(t)}function p(){e.page<e.pages.length&&r(++e.page)}function l(){e.page>1&&r(--e.page)}function o(){t.get(a.ngpCountUrl).then(g)}function i(){for(var t=isNaN(t)?8:t,n=isNaN(n)?10:n,a=[],g=[],r=0,p=0,l=Math.floor(e.total/e.pageCount);p<l;p++)a.push(++r);return e.total%e.pageCount&&a.push(++r),a.length>7?g=u(e.page,t,a):a}function u(t,e,n){for(var a=[],g=[],r=[],p=[],l=--t,o=--l;o>=0;o--)a.unshift(n[o]);for(var i=++l;i<n.length;i++)g.push(n[i]);var u=f(e-2,a.length,n),s=h(u,a,g);r=s.left,r.push(n[l]),p=s.right;var c=r.concat(p);return c.length>e&&c.splice(1,1),c}function h(t,e,n){for(var a=Math.ceil(e.length/t.left),g=Math.ceil(n.length/t.right),r=[],p=[],l=0;l<e.length;l+=a)r.push(e[l]);if(1===n.length)p.push(n[0]);else for(var o=n.length-1;o>0;o-=g)p.unshift(n[o]);var i={left:r,right:p};return i}function f(t,e,n){var a=s(e,n.length),g=Math.ceil(t*a.integer/100),r=Math.abs(t-g),p={left:0,right:0};return a.decimal>=5?(p.left=++g,p.right=r):(p.left=g,p.right=++r),p}function s(t,e){return{integer:Math.floor(100*t/e),decimal:Number(String(100*t/e%1).charAt(2))}}e.setPage=r,e.reset=o,e.next=p,e.prev=l,e.pages=i,e.page=1,o()}function n(t,e){return e.ngpTemplateUrl}var a={templateUrl:n,link:e,restrict:"A",scope:{pager:"=ngpPager"}};return a}var n=t.angular;n.module("ngPager",[]).directive("ngPager",["$http",e])}(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5nLXBhZ2VyLmpzIl0sIm5hbWVzIjpbIndpbmRvdyIsIm5nUGFnaW5hdGlvbkRpcmVjdGl2ZUZuIiwiJGh0dHAiLCJuZ1BhZ2luYXRpb25EaXJlY3RpdmVMaW5rRm4iLCIkc2NvcGUiLCIkZWxlbWVudCIsIiRhdHRycyIsIm9uQ291bnRTdWNjZXNzIiwicmVzIiwidG90YWwiLCJwYXJzZUludCIsImRhdGEiLCJwYWdlQ291bnQiLCJuZ3BQYWdlQ291bnQiLCJwYWdlcyIsImRlZmluZVBhZ2VzIiwiY29uc29sZSIsImxvZyIsIm5ncFN0YXJ0UGFnZSIsInBhZ2UiLCJsZW5ndGgiLCJzZXRQYWdlIiwicGFnZXIiLCJuZXh0IiwicHJldiIsInJlc2V0IiwiZ2V0IiwibmdwQ291bnRVcmwiLCJ0aGVuIiwiZGlzcGxheVNpemUiLCJpc05hTiIsImVsZW1lbnRzUGVyUGFnZSIsImFsbFBhZ2VzIiwiaSIsImwiLCJNYXRoIiwiZmxvb3IiLCJwdXNoIiwiZml4ZWRQYWdlciIsImxlZnRBbGwiLCJyaWdodEFsbCIsImxlZnRTaG93biIsInJpZ2h0U2hvd24iLCJ6ZXJvSW5kZXhQYWdlIiwidW5zaGlmdCIsImoiLCJiYWwiLCJiYWxhbmNlIiwiYmFsYW5jZVBhZ2VzIiwiZGVwbG95UGFnZXMiLCJsZWZ0IiwicmlnaHQiLCJzaG93blBhZ2VzIiwiY29uY2F0Iiwic3BsaWNlIiwibGVmdFN0ZXAiLCJjZWlsIiwicmlnaHRTdGVwIiwibGVmdFNlbGVjdGlvbiIsInJpZ2h0U2VsZWN0aW9uIiwic2VsZWN0aW9uIiwibGVmdEFsbExlbmd0aCIsInBlcmNlbnRhZ2UiLCJwZXJjZW50IiwibGVmdEJhbGFuY2UiLCJpbnRlZ2VyIiwicmlnaHRCYWxhbmNlIiwiYWJzIiwiYmFsYW5jZU91dCIsImRlY2ltYWwiLCJ2YWx1ZSIsIk51bWJlciIsIlN0cmluZyIsImNoYXJBdCIsIm5nUGFnaW5hdGlvbkRpcmVjdGl2ZVRlbXBsYXRlVXJsRm4iLCJuZ3BUZW1wbGF0ZVVybCIsIm5nUGFnaW5hdGlvbkRpcmVjdGl2ZURlZiIsInRlbXBsYXRlVXJsIiwibGluayIsInJlc3RyaWN0Iiwic2NvcGUiLCJuZyIsImFuZ3VsYXIiLCJtb2R1bGUiLCJkaXJlY3RpdmUiXSwibWFwcGluZ3MiOiJDQUFDLFNBQVVBLEdBQ1QsWUFTQSxTQUFTQyxHQUF3QkMsR0FNL0IsUUFBU0MsR0FBNEJDLEVBQVFDLEVBQVVDLEdBTXJELFFBQVNDLEdBQWVDLEdBQ3RCSixFQUFPSyxNQUFRQyxTQUFTRixFQUFJRyxNQUFRLEdBQ3BDUCxFQUFPUSxVQUFZRixTQUFTSixFQUFPTyxjQUNuQ1QsRUFBT1UsTUFBUUMsSUFDZkMsUUFBUUMsSUFBSSxTQUFVYixFQUFPVSxPQUV6QlIsRUFBT1ksZUFDVGQsRUFBT2UsS0FBT1QsU0FBU0osRUFBT1ksZUFBaUIsRUFFM0NkLEVBQU9lLEtBQU9mLEVBQU9VLE1BQU1NLFNBQzdCaEIsRUFBT2UsS0FBT2YsRUFBT1UsTUFBTU0sUUFHekJoQixFQUFPZSxLQUFPLElBQ2hCZixFQUFPZSxLQUFPLEdBR2hCSCxRQUFRQyxJQUFJLGVBQWlCYixFQUFPZSxPQVN4QyxRQUFTRSxHQUFRRixHQUNmZixFQUFPZSxLQUFPQSxFQUNkZixFQUFPa0IsTUFBTUgsR0FNZixRQUFTSSxLQUNIbkIsRUFBT2UsS0FBT2YsRUFBT1UsTUFBTU0sUUFDN0JDLElBQVVqQixFQUFPZSxNQU9yQixRQUFTSyxLQUNIcEIsRUFBT2UsS0FBTyxHQUNoQkUsSUFBVWpCLEVBQU9lLE1BSXJCLFFBQVNNLEtBQ1B2QixFQUFNd0IsSUFBSXBCLEVBQU9xQixhQUNkQyxLQUFLckIsR0FNVixRQUFTUSxLQVNQLElBQUssR0FQRGMsR0FBZUMsTUFBTUQsR0FBZ0IsRUFBSUEsRUFDekNFLEVBQW1CRCxNQUFNQyxHQUFvQixHQUFLQSxFQUVsREMsS0FDQWxCLEtBQ0FLLEVBQU8sRUFFRmMsRUFBSSxFQUFHQyxFQUFJQyxLQUFLQyxNQUFNaEMsRUFBT0ssTUFBUUwsRUFBT1EsV0FDakRxQixFQUFJQyxFQUFHRCxJQUNMRCxFQUFTSyxPQUFPbEIsRUFPdEIsT0FKSWYsR0FBT0ssTUFBUUwsRUFBT1EsV0FDeEJvQixFQUFTSyxPQUFPbEIsR0FHZGEsRUFBU1osT0FBUyxFQUNwQk4sRUFBUXdCLEVBQVdsQyxFQUFPZSxLQUFNVSxFQUFhRyxHQUd0Q0EsRUFRWCxRQUFTTSxHQUFXbkIsRUFBTVUsRUFBYUcsR0FTckMsSUFBSyxHQVJETyxNQUNBQyxLQUVBQyxLQUNBQyxLQUVBQyxJQUFrQnhCLEVBRWJjLElBQU1VLEVBQWVWLEdBQUssRUFBR0EsSUFDcENNLEVBQVFLLFFBQVFaLEVBQVNDLEdBRzNCLEtBQUssR0FBSVksS0FBTUYsRUFBZUUsRUFBSWIsRUFBU1osT0FBUXlCLElBQ2pETCxFQUFTSCxLQUFLTCxFQUFTYSxHQUd6QixJQUFJQyxHQUFNQyxFQUFRbEIsRUFBYyxFQUFHVSxFQUFRbkIsT0FBUVksR0FDL0NnQixFQUFlQyxFQUFZSCxFQUFLUCxFQUFTQyxFQUU3Q0MsR0FBWU8sRUFBYUUsS0FDekJULEVBQVVKLEtBQUtMLEVBQVNXLElBQ3hCRCxFQUFhTSxFQUFhRyxLQUUxQixJQUFJQyxHQUFhWCxFQUFVWSxPQUFPWCxFQU1sQyxPQUpJVSxHQUFXaEMsT0FBU1MsR0FDdEJ1QixFQUFXRSxPQUFPLEVBQUcsR0FHaEJGLEVBUVQsUUFBU0gsR0FBWUYsRUFBU1IsRUFBU0MsR0FRckMsSUFBSyxHQU5EZSxHQUFXcEIsS0FBS3FCLEtBQUtqQixFQUFRbkIsT0FBUzJCLEVBQVFHLE1BQzlDTyxFQUFZdEIsS0FBS3FCLEtBQUtoQixFQUFTcEIsT0FBUzJCLEVBQVFJLE9BRWhETyxLQUNBQyxLQUVLMUIsRUFBSSxFQUFHQSxFQUFJTSxFQUFRbkIsT0FBUWEsR0FBS3NCLEVBQ3ZDRyxFQUFjckIsS0FBS0UsRUFBUU4sR0FHN0IsSUFBd0IsSUFBcEJPLEVBQVNwQixPQUNYdUMsRUFBZXRCLEtBQUtHLEVBQVMsUUFFN0IsS0FBSyxHQUFJSyxHQUFJTCxFQUFTcEIsT0FBUyxFQUFHeUIsRUFBSSxFQUFHQSxHQUFLWSxFQUM1Q0UsRUFBZWYsUUFBUUosRUFBU0ssR0FJcEMsSUFBSWUsSUFDRlYsS0FBTVEsRUFDTlAsTUFBT1EsRUFHVCxPQUFPQyxHQU9ULFFBQVNiLEdBQVFsQixFQUFhZ0MsRUFBZTdCLEdBQzNDLEdBQUk4QixHQUFhQyxFQUFRRixFQUFlN0IsRUFBU1osUUFFN0M0QyxFQUFjN0IsS0FBS3FCLEtBQU0zQixFQUFjaUMsRUFBV0csUUFBVyxLQUM3REMsRUFBZS9CLEtBQUtnQyxJQUFJdEMsRUFBY21DLEdBRXRDSSxHQUNGbEIsS0FBTSxFQUNOQyxNQUFPLEVBVVQsT0FQSVcsR0FBV08sU0FBVyxHQUN4QkQsRUFBV2xCLE9BQVNjLEVBQ3BCSSxFQUFXakIsTUFBUWUsSUFFbkJFLEVBQVdsQixLQUFPYyxFQUNsQkksRUFBV2pCLFFBQVVlLEdBRWhCRSxFQUdULFFBQVNMLEdBQVFPLEVBQU83RCxHQUN0QixPQUNFd0QsUUFBUzlCLEtBQUtDLE1BQU8sSUFBTWtDLEVBQVM3RCxHQUNwQzRELFFBQVNFLE9BQU9DLE9BQVMsSUFBTUYsRUFBUzdELEVBQVMsR0FBR2dFLE9BQU8sS0FJL0RyRSxFQUFPaUIsUUFBVUEsRUFDakJqQixFQUFPcUIsTUFBUUEsRUFDZnJCLEVBQU9tQixLQUFPQSxFQUNkbkIsRUFBT29CLEtBQU9BLEVBQ2RwQixFQUFPVSxNQUFRQyxFQUNmWCxFQUFPZSxLQUFPLEVBRWRNLElBUUYsUUFBU2lELEdBQW1DckUsRUFBVUMsR0FDcEQsTUFBT0EsR0FBT3FFLGVBSWhCLEdBQUlDLElBQ0ZDLFlBQWFILEVBRWJJLEtBQU0zRSxFQUVONEUsU0FBVSxJQUVWQyxPQUNFMUQsTUFBTyxhQUlYLE9BQU9zRCxHQTVPVCxHQUFJSyxHQUFLakYsRUFBT2tGLE9BZ1BoQkQsR0FBR0UsT0FBTyxjQUdUQyxVQUFVLFdBQ1QsUUFFQW5GLEtBR0ZEIiwiZmlsZSI6Im5nLXBhZ2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICh3aW5kb3cpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHZhciBuZyA9IHdpbmRvdy5hbmd1bGFyO1xuXG4gIC8qKlxuICAgKiBQYWdpbmF0aW9uIGRpcmVjdGl2ZSBmdW5jdGlvbi5cbiAgICpcbiAgICogQHR5cGUgQW5ndWxhckpTIERpcmVjdGl2ZSBGdW5jdGlvblxuICAgKi9cbiAgZnVuY3Rpb24gbmdQYWdpbmF0aW9uRGlyZWN0aXZlRm4oJGh0dHApIHtcbiAgICAvKipcbiAgICAgKiBQYWdpbmF0aW9uIGRpcmVjdGl2ZSBsaW5rIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHR5cGUgQW5ndWxhckpTIERpcmVjdGl2ZSBMaW5rIEZ1bmN0aW9uXG4gICAgICovXG4gICAgZnVuY3Rpb24gbmdQYWdpbmF0aW9uRGlyZWN0aXZlTGlua0ZuKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xuICAgICAgLyoqXG4gICAgICAgKiBPbiBjb3VudCByZXF1ZXN0IHN1Y2Nlc3MuXG4gICAgICAgKlxuICAgICAgICogQHR5cGUgJGh0dHAgdGhlbiBjYWxsYmFjay5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gb25Db3VudFN1Y2Nlc3MocmVzKSB7XG4gICAgICAgICRzY29wZS50b3RhbCA9IHBhcnNlSW50KHJlcy5kYXRhIHx8IDApO1xuICAgICAgICAkc2NvcGUucGFnZUNvdW50ID0gcGFyc2VJbnQoJGF0dHJzLm5ncFBhZ2VDb3VudCk7XG4gICAgICAgICRzY29wZS5wYWdlcyA9IGRlZmluZVBhZ2VzKCk7IC8qbmV3IEFycmF5KE1hdGguY2VpbCgkc2NvcGUudG90YWwgLyAkc2NvcGUucGFnZUNvdW50KSk7Ki9cbiAgICAgICAgY29uc29sZS5sb2coJ1BBR0VTOicsICRzY29wZS5wYWdlcyk7XG5cbiAgICAgICAgaWYgKCRhdHRycy5uZ3BTdGFydFBhZ2UpIHtcbiAgICAgICAgICAkc2NvcGUucGFnZSA9IHBhcnNlSW50KCRhdHRycy5uZ3BTdGFydFBhZ2UpIHx8IDE7XG5cbiAgICAgICAgICBpZiAoJHNjb3BlLnBhZ2UgPiAkc2NvcGUucGFnZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAkc2NvcGUucGFnZSA9ICRzY29wZS5wYWdlcy5sZW5ndGg7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCRzY29wZS5wYWdlIDwgMSkge1xuICAgICAgICAgICAgJHNjb3BlLnBhZ2UgPSAxO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnNvbGUubG9nKCdTdGFydCBwYWdlOiAnICsgJHNjb3BlLnBhZ2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogU2V0cyB0aGUgY3VycmVudCBwYWdlLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBwYWdlIFRoZSBwYWdlIG51bWJlciB0byBzZXQuXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIHNldFBhZ2UocGFnZSkge1xuICAgICAgICAkc2NvcGUucGFnZSA9IHBhZ2U7XG4gICAgICAgICRzY29wZS5wYWdlcihwYWdlKTtcbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBHb2VzIHRvIHRoZSBuZXh0IHBhZ2UuXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgIGlmICgkc2NvcGUucGFnZSA8ICRzY29wZS5wYWdlcy5sZW5ndGgpIHtcbiAgICAgICAgICBzZXRQYWdlKCsrJHNjb3BlLnBhZ2UpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogR29lcyB0byB0aGUgcHJldmlvdXMgcGFnZS5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gcHJldigpIHtcbiAgICAgICAgaWYgKCRzY29wZS5wYWdlID4gMSkge1xuICAgICAgICAgIHNldFBhZ2UoLS0kc2NvcGUucGFnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gcmVzZXQoKSB7XG4gICAgICAgICRodHRwLmdldCgkYXR0cnMubmdwQ291bnRVcmwpXG4gICAgICAgICAgLnRoZW4ob25Db3VudFN1Y2Nlc3MpO1xuICAgICAgfVxuXG4gICAgICAvKipcbiAgICAgICAqIFNldHMgZGluYW1pYyBsaXN0IG9mIGRpc3BsYXllZCBicm93c2FibGUgcGFnZXMuXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGRlZmluZVBhZ2VzKCkge1xuICAgICAgICBcbiAgICAgICAgdmFyIGRpc3BsYXlTaXplID0gKGlzTmFOKGRpc3BsYXlTaXplKSkgPyA4IDogZGlzcGxheVNpemU7XG4gICAgICAgIHZhciBlbGVtZW50c1BlclBhZ2UgPSAoaXNOYU4oZWxlbWVudHNQZXJQYWdlKSkgPyAxMCA6IGVsZW1lbnRzUGVyUGFnZTtcblxuICAgICAgICB2YXIgYWxsUGFnZXMgPSBbXTtcbiAgICAgICAgdmFyIHBhZ2VzID0gW107XG4gICAgICAgIHZhciBwYWdlID0gMDtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IE1hdGguZmxvb3IoJHNjb3BlLnRvdGFsIC8gJHNjb3BlLnBhZ2VDb3VudCk7XG4gICAgICAgICAgICBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgIGFsbFBhZ2VzLnB1c2goKytwYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgkc2NvcGUudG90YWwgJSAkc2NvcGUucGFnZUNvdW50KSB7XG4gICAgICAgICAgYWxsUGFnZXMucHVzaCgrK3BhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoYWxsUGFnZXMubGVuZ3RoID4gNykge1xuICAgICAgICAgIHBhZ2VzID0gZml4ZWRQYWdlcigkc2NvcGUucGFnZSwgZGlzcGxheVNpemUsIGFsbFBhZ2VzKTtcbiAgICAgICAgICByZXR1cm4gcGFnZXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGFsbFBhZ2VzO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogU2VwYXJhdGVzIGxpc3Qgb2YgcGFnZXMgaW50byB0d28gYXJyYXlzOiBsZWZ0IGFuZCByaWdodCBmcm9tIGN1cnJlbnQgcGFnZS4gXG4gICAgICAgKiBUaGVuIGNvbmNhdGVuYXRlcyBib3RoIHBsdXMgY3VycmVudCBwYWdlIHRvIHJldHVybiBhbiBhcnJheSBhcyBmaW5hbCBvdXRwdXQuXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGZpeGVkUGFnZXIocGFnZSwgZGlzcGxheVNpemUsIGFsbFBhZ2VzKSB7XG4gICAgICAgIHZhciBsZWZ0QWxsID0gW107XG4gICAgICAgIHZhciByaWdodEFsbCA9IFtdO1xuXG4gICAgICAgIHZhciBsZWZ0U2hvd24gPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0U2hvd24gPSBbXTtcblxuICAgICAgICB2YXIgemVyb0luZGV4UGFnZSA9IC0tcGFnZTtcblxuICAgICAgICBmb3IgKHZhciBpID0gLS16ZXJvSW5kZXhQYWdlOyBpID49IDA7IGktLSkge1xuICAgICAgICAgIGxlZnRBbGwudW5zaGlmdChhbGxQYWdlc1tpXSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBqID0gKyt6ZXJvSW5kZXhQYWdlOyBqIDwgYWxsUGFnZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICByaWdodEFsbC5wdXNoKGFsbFBhZ2VzW2pdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBiYWwgPSBiYWxhbmNlKGRpc3BsYXlTaXplIC0gMiwgbGVmdEFsbC5sZW5ndGgsIGFsbFBhZ2VzKTtcbiAgICAgICAgdmFyIGJhbGFuY2VQYWdlcyA9IGRlcGxveVBhZ2VzKGJhbCwgbGVmdEFsbCwgcmlnaHRBbGwpO1xuXG4gICAgICAgIGxlZnRTaG93biA9IGJhbGFuY2VQYWdlcy5sZWZ0O1xuICAgICAgICBsZWZ0U2hvd24ucHVzaChhbGxQYWdlc1t6ZXJvSW5kZXhQYWdlXSk7XG4gICAgICAgIHJpZ2h0U2hvd24gPSBiYWxhbmNlUGFnZXMucmlnaHQ7XG5cbiAgICAgICAgdmFyIHNob3duUGFnZXMgPSBsZWZ0U2hvd24uY29uY2F0KHJpZ2h0U2hvd24pO1xuXG4gICAgICAgIGlmIChzaG93blBhZ2VzLmxlbmd0aCA+IGRpc3BsYXlTaXplKSB7XG4gICAgICAgICAgc2hvd25QYWdlcy5zcGxpY2UoMSwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2hvd25QYWdlcztcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLyoqXG4gICAgICAgKiBTdGVwcyB0aHJvdWdoIGVhY2ggYXJyYXkgb2YgcGFnZXMgZm9sbG93aW5nIHRoZSBsZWZ0L3JpZ2h0IGJhbGFuY2UgZGV0ZXJtaW5lZCBieSB0aGUgcGVyY2VudGFnZSBvZlxuICAgICAgICogcGFnZXMgcmVnYXJkaW5nIHRoZSB0b3RhbC4gUmV0dXJucyB0d28gYXJyYXlzIGNvbnRhaW5pbmcgZWFjaCBhIHNlbGVjdGlvbiBvZiBsZWZ0IGFuZCByaWdodFxuICAgICAgICogcGFnZXMgdG8gZGlzcGxheS5cbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gZGVwbG95UGFnZXMoYmFsYW5jZSwgbGVmdEFsbCwgcmlnaHRBbGwpIHtcbiAgICAgICAgXG4gICAgICAgIHZhciBsZWZ0U3RlcCA9IE1hdGguY2VpbChsZWZ0QWxsLmxlbmd0aCAvIGJhbGFuY2UubGVmdCk7XG4gICAgICAgIHZhciByaWdodFN0ZXAgPSBNYXRoLmNlaWwocmlnaHRBbGwubGVuZ3RoIC8gYmFsYW5jZS5yaWdodCk7XG5cbiAgICAgICAgdmFyIGxlZnRTZWxlY3Rpb24gPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0U2VsZWN0aW9uID0gW107XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZWZ0QWxsLmxlbmd0aDsgaSArPSBsZWZ0U3RlcCkge1xuICAgICAgICAgIGxlZnRTZWxlY3Rpb24ucHVzaChsZWZ0QWxsW2ldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyaWdodEFsbC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICByaWdodFNlbGVjdGlvbi5wdXNoKHJpZ2h0QWxsWzBdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKHZhciBqID0gcmlnaHRBbGwubGVuZ3RoIC0gMTsgaiA+IDA7IGogLT0gcmlnaHRTdGVwKSB7XG4gICAgICAgICAgICByaWdodFNlbGVjdGlvbi51bnNoaWZ0KHJpZ2h0QWxsW2pdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2VsZWN0aW9uID0ge1xuICAgICAgICAgIGxlZnQ6IGxlZnRTZWxlY3Rpb24sXG4gICAgICAgICAgcmlnaHQ6IHJpZ2h0U2VsZWN0aW9uXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gc2VsZWN0aW9uO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvKipcbiAgICAgICAqIERldGVybWluZXMgdGhlIGJhbGFuY2Ugb2YgcGFnZXMgdG8gYmUgc2hvd24gdG8gZWFjaCB0aGUgbGVmdCBhbmQgdGhlIHJpZ2h0IHNpZGVzXG4gICAgICAgKiByZWdhcmRpbmcgdGhlIGRlc2lyZWQgdG90YWwgYW1vdW50IG9mIHBhZ2VzIHRvIGRpc3BsYXkuXG4gICAgICAgKiAqL1xuICAgICAgZnVuY3Rpb24gYmFsYW5jZShkaXNwbGF5U2l6ZSwgbGVmdEFsbExlbmd0aCwgYWxsUGFnZXMpIHtcbiAgICAgICAgdmFyIHBlcmNlbnRhZ2UgPSBwZXJjZW50KGxlZnRBbGxMZW5ndGgsIGFsbFBhZ2VzLmxlbmd0aCk7XG4gICAgICAgIFxuICAgICAgICB2YXIgbGVmdEJhbGFuY2UgPSBNYXRoLmNlaWwoKGRpc3BsYXlTaXplICogcGVyY2VudGFnZS5pbnRlZ2VyKSAvIDEwMCk7XG4gICAgICAgIHZhciByaWdodEJhbGFuY2UgPSBNYXRoLmFicyhkaXNwbGF5U2l6ZSAtIGxlZnRCYWxhbmNlKTtcbiAgICAgICAgXG4gICAgICAgIHZhciBiYWxhbmNlT3V0ID0ge1xuICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgcmlnaHQ6IDBcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAocGVyY2VudGFnZS5kZWNpbWFsID49IDUpIHtcbiAgICAgICAgICBiYWxhbmNlT3V0LmxlZnQgPSArK2xlZnRCYWxhbmNlO1xuICAgICAgICAgIGJhbGFuY2VPdXQucmlnaHQgPSByaWdodEJhbGFuY2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYmFsYW5jZU91dC5sZWZ0ID0gbGVmdEJhbGFuY2U7XG4gICAgICAgICAgYmFsYW5jZU91dC5yaWdodCA9ICsrcmlnaHRCYWxhbmNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiYWxhbmNlT3V0O1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBwZXJjZW50KHZhbHVlLCB0b3RhbCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGludGVnZXI6IE1hdGguZmxvb3IoKDEwMCAqIHZhbHVlKSAvIHRvdGFsKSxcbiAgICAgICAgICBkZWNpbWFsOiBOdW1iZXIoU3RyaW5nKCgoMTAwICogdmFsdWUpIC8gdG90YWwpICUgMSkuY2hhckF0KDIpKVxuICAgICAgICB9IFxuICAgICAgfVxuXG4gICAgICAkc2NvcGUuc2V0UGFnZSA9IHNldFBhZ2U7XG4gICAgICAkc2NvcGUucmVzZXQgPSByZXNldDtcbiAgICAgICRzY29wZS5uZXh0ID0gbmV4dDtcbiAgICAgICRzY29wZS5wcmV2ID0gcHJldjtcbiAgICAgICRzY29wZS5wYWdlcyA9IGRlZmluZVBhZ2VzO1xuICAgICAgJHNjb3BlLnBhZ2UgPSAxO1xuXG4gICAgICByZXNldCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhZ2luYXRpb24gZGlyZWN0aXZlIHRlbXBsYXRlIFVSTCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEB0eXBlIEFuZ3VsYXJKUyBEaXJlY3RpdmUgVGVtcGxhdGUgVVJMIEZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZVRlbXBsYXRlVXJsRm4oJGVsZW1lbnQsICRhdHRycykge1xuICAgICAgcmV0dXJuICRhdHRycy5uZ3BUZW1wbGF0ZVVybDtcbiAgICB9XG5cbiAgICAvKiBQYWdpbmF0aW9uIGRpcmVjdGl2ZSBkZWZpbml0aW9uICovXG4gICAgdmFyIG5nUGFnaW5hdGlvbkRpcmVjdGl2ZURlZiA9IHtcbiAgICAgIHRlbXBsYXRlVXJsOiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVUZW1wbGF0ZVVybEZuLFxuXG4gICAgICBsaW5rOiBuZ1BhZ2luYXRpb25EaXJlY3RpdmVMaW5rRm4sXG5cbiAgICAgIHJlc3RyaWN0OiAnQScsXG5cbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIHBhZ2VyOiAnPW5ncFBhZ2VyJ1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gbmdQYWdpbmF0aW9uRGlyZWN0aXZlRGVmO1xuICB9XG5cbiAgLyogRGVmaW5lIHRoZSBBbmd1bGFySlMgbW9kdWxlICovXG4gIG5nLm1vZHVsZSgnbmdQYWdlcicsIFtdKVxuXG4gIC8qIERlZmluZSB0aGUgQW5ndWxhckpTIGRpcmVjdGl2ZSAqL1xuICAuZGlyZWN0aXZlKCduZ1BhZ2VyJywgW1xuICAgICckaHR0cCcsXG5cbiAgICBuZ1BhZ2luYXRpb25EaXJlY3RpdmVGblxuICBdKTtcblxufSh3aW5kb3cpKTtcbiJdfQ==
